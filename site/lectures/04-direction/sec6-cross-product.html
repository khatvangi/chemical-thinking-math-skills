<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>What's Perpendicular? | Cross Product</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,400;9..144,600&family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-tertiary: #1a1a25;
            --text-primary: #e8e6e3;
            --text-secondary: #a9a6a0;
            --text-muted: #6b6966;
            --accent-blue: #4a9eff;
            --accent-purple: #9d7aff;
            --accent-green: #4ade80;
            --accent-red: #f87171;
            --accent-yellow: #fbbf24;
            --accent-cyan: #22d3ee;
            --accent-orange: #fb923c;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.7;
            min-height: 100vh;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
        }

        h1, h2, h3 {
            font-family: 'Fraunces', serif;
            font-weight: 600;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1.2rem;
            margin-bottom: 3rem;
        }

        h2 {
            font-size: 1.6rem;
            color: var(--accent-purple);
            margin: 3rem 0 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--bg-tertiary);
        }

        h3 {
            font-size: 1.2rem;
            color: var(--text-primary);
            margin: 2rem 0 1rem;
        }

        p {
            margin-bottom: 1rem;
            color: var(--text-secondary);
        }

        .visual-container {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 2rem 0;
            border: 1px solid var(--bg-tertiary);
        }

        canvas {
            display: block;
            margin: 0 auto;
            border-radius: 8px;
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            margin-top: 1.5rem;
            justify-content: center;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .control-group label {
            font-size: 0.85rem;
            color: var(--text-muted);
            font-family: 'JetBrains Mono', monospace;
        }

        input[type="range"] {
            width: 140px;
            accent-color: var(--accent-purple);
        }

        .value-display {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            color: var(--accent-purple);
        }

        .formula-box {
            background: var(--bg-tertiary);
            border-left: 3px solid var(--accent-purple);
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            font-family: 'JetBrains Mono', monospace;
            border-radius: 0 8px 8px 0;
        }

        .formula-box .main {
            font-size: 1.1rem;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .formula-box .explanation {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .insight-box {
            background: linear-gradient(135deg, rgba(157, 122, 255, 0.1), rgba(251, 146, 60, 0.1));
            border: 1px solid var(--accent-purple);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 2rem 0;
        }

        .insight-box h4 {
            color: var(--accent-orange);
            margin-bottom: 0.5rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
        }

        .causal-chain {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
        }

        .chain-step {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            margin: 0.5rem 0;
            background: var(--bg-tertiary);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .chain-step:hover {
            transform: translateX(5px);
            border-left: 3px solid var(--accent-purple);
        }

        .chain-step.active {
            border-left: 3px solid var(--accent-orange);
            background: rgba(251, 146, 60, 0.1);
        }

        .chain-arrow {
            color: var(--accent-purple);
            font-size: 1.5rem;
            text-align: center;
            padding: 0.5rem 0;
        }

        .step-number {
            width: 30px;
            height: 30px;
            background: var(--accent-purple);
            color: var(--bg-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        .step-content {
            flex: 1;
        }

        .step-title {
            color: var(--text-primary);
            font-weight: 500;
        }

        .step-detail {
            font-size: 0.85rem;
            color: var(--text-muted);
            display: none;
        }

        .chain-step.active .step-detail {
            display: block;
            margin-top: 0.5rem;
        }

        .example-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .example-card {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid var(--bg-tertiary);
            transition: all 0.3s ease;
        }

        .example-card:hover {
            border-color: var(--accent-purple);
            transform: translateY(-2px);
        }

        .example-card h4 {
            color: var(--accent-orange);
            margin-bottom: 0.75rem;
            font-size: 1rem;
        }

        .example-card canvas {
            margin: 1rem 0;
        }

        .example-card .result {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            color: var(--accent-green);
            text-align: center;
            padding: 0.5rem;
            background: var(--bg-tertiary);
            border-radius: 4px;
        }

        .practice-section {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 2rem;
            margin: 3rem 0;
        }

        .problem {
            background: var(--bg-tertiary);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .problem-question {
            color: var(--text-primary);
            margin-bottom: 1rem;
        }

        .problem-options {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        .option-btn {
            padding: 0.75rem 1.5rem;
            background: var(--bg-secondary);
            border: 1px solid var(--bg-tertiary);
            color: var(--text-secondary);
            border-radius: 8px;
            cursor: pointer;
            font-family: 'JetBrains Mono', monospace;
            transition: all 0.3s ease;
        }

        .option-btn:hover {
            border-color: var(--accent-purple);
            color: var(--text-primary);
        }

        .option-btn.correct {
            background: var(--accent-green);
            color: var(--bg-primary);
            border-color: var(--accent-green);
        }

        .option-btn.incorrect {
            background: var(--accent-red);
            color: var(--bg-primary);
            border-color: var(--accent-red);
        }

        .feedback {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 8px;
            display: none;
        }

        .feedback.show {
            display: block;
        }

        .feedback.correct {
            background: rgba(74, 222, 128, 0.1);
            border: 1px solid var(--accent-green);
            color: var(--accent-green);
        }

        .feedback.incorrect {
            background: rgba(248, 113, 113, 0.1);
            border: 1px solid var(--accent-red);
            color: var(--accent-red);
        }

        .result-display {
            text-align: center;
            padding: 1rem;
            background: var(--bg-tertiary);
            border-radius: 8px;
            margin-top: 1rem;
        }

        .cross-value {
            font-size: 1.5rem;
            font-family: 'Fraunces', serif;
            font-weight: 600;
            color: var(--accent-orange);
        }

        .direction-label {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-top: 0.5rem;
        }

        .nav-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--accent-purple);
            text-decoration: none;
            padding: 0.5rem 1rem;
            border: 1px solid var(--accent-purple);
            border-radius: 8px;
            margin: 2rem 0;
            transition: all 0.3s ease;
        }

        .nav-link:hover {
            background: var(--accent-purple);
            color: var(--bg-primary);
        }

        .hand-rule {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            padding: 2rem;
            background: var(--bg-tertiary);
            border-radius: 12px;
            margin: 2rem 0;
        }

        .hand-rule-step {
            display: flex;
            align-items: center;
            gap: 1rem;
            color: var(--text-secondary);
        }

        .hand-rule-step .finger {
            font-size: 1.5rem;
        }

        .hand-rule-step .text {
            font-family: 'JetBrains Mono', monospace;
        }

        .determinant-box {
            background: var(--bg-tertiary);
            padding: 1.5rem;
            border-radius: 12px;
            margin: 2rem 0;
            text-align: center;
            font-family: 'JetBrains Mono', monospace;
        }

        .matrix {
            display: inline-flex;
            flex-direction: column;
            gap: 0.5rem;
            padding: 0.5rem;
            border-left: 2px solid var(--accent-purple);
            border-right: 2px solid var(--accent-purple);
        }

        .matrix-row {
            display: flex;
            gap: 1.5rem;
            justify-content: center;
        }

        .matrix-row span {
            min-width: 30px;
            text-align: center;
        }

        .unit-vec { color: var(--accent-orange); }
        .vec-a { color: var(--accent-blue); }
        .vec-b { color: var(--accent-cyan); }

        .chirality-demo {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin: 2rem 0;
        }

        .chiral-molecule {
            text-align: center;
        }

        .chiral-label {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.2rem;
            margin-top: 1rem;
        }

        .chiral-label.l-form { color: var(--accent-blue); }
        .chiral-label.d-form { color: var(--accent-orange); }

        @media (max-width: 600px) {
            .chirality-demo {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="sec5-dot-product.html" class="nav-link">‚Üê Section 5: How Aligned?</a>

        <h1>What's Perpendicular?</h1>
        <p class="subtitle">Finding the direction that stands apart from both</p>

        <!-- Opening Visual: Two bonds, what's perpendicular to both? -->
        <div class="visual-container">
            <canvas id="crossCanvas" width="700" height="400"></canvas>
            <div class="controls">
                <div class="control-group">
                    <label>Rotate a</label>
                    <input type="range" id="aAngle" min="0" max="360" value="30">
                    <span class="value-display" id="aAngleVal">30¬∞</span>
                </div>
                <div class="control-group">
                    <label>Rotate b</label>
                    <input type="range" id="bAngle" min="0" max="360" value="120">
                    <span class="value-display" id="bAngleVal">120¬∞</span>
                </div>
            </div>
            <div class="result-display">
                <div class="cross-value" id="crossMag">|a √ó b| = 0.87</div>
                <div class="direction-label" id="crossDir">a √ó b points out of the screen</div>
            </div>
        </div>

        <p>Given two directions in a plane, what direction is perpendicular to <em>both</em>? The cross product answers: a vector that points straight out of their shared plane.</p>

        <!-- Causal Chain: Why perpendicular matters -->
        <h2>Why Perpendicular Matters</h2>

        <div class="causal-chain">
            <div class="chain-step active" data-step="1">
                <div class="step-number">1</div>
                <div class="step-content">
                    <div class="step-title">A carbon with four different groups</div>
                    <div class="step-detail">Three bonds define a plane; the fourth group can point in two directions</div>
                </div>
            </div>
            <div class="chain-arrow">‚Üì</div>
            <div class="chain-step" data-step="2">
                <div class="step-number">2</div>
                <div class="step-content">
                    <div class="step-title">Two possible perpendicular directions</div>
                    <div class="step-detail">Up or down from the plane ‚Üí two mirror-image molecules</div>
                </div>
            </div>
            <div class="chain-arrow">‚Üì</div>
            <div class="chain-step" data-step="3">
                <div class="step-number">3</div>
                <div class="step-content">
                    <div class="step-title">Chirality emerges</div>
                    <div class="step-detail">L and D forms: same atoms, different handedness</div>
                </div>
            </div>
            <div class="chain-arrow">‚Üì</div>
            <div class="chain-step" data-step="4">
                <div class="step-number">4</div>
                <div class="step-content">
                    <div class="step-title">Biology distinguishes them</div>
                    <div class="step-detail">Your body uses only L-amino acids and D-sugars</div>
                </div>
            </div>
        </div>

        <div class="insight-box">
            <h4>THE QUESTION</h4>
            <p>Given two directions a and b, what's the unique direction perpendicular to both? And how much "area" do they span together?</p>
        </div>

        <!-- The Right-Hand Rule -->
        <h2>The Right-Hand Rule</h2>

        <div class="visual-container">
            <canvas id="rightHandCanvas" width="700" height="350"></canvas>
        </div>

        <div class="hand-rule">
            <div class="hand-rule-step">
                <span class="finger">üëâ</span>
                <span class="text">Point your fingers along <span style="color: var(--accent-blue)">a</span></span>
            </div>
            <div class="hand-rule-step">
                <span class="finger">‚úã</span>
                <span class="text">Curl them toward <span style="color: var(--accent-cyan)">b</span></span>
            </div>
            <div class="hand-rule-step">
                <span class="finger">üëç</span>
                <span class="text">Your thumb points along <span style="color: var(--accent-orange)">a √ó b</span></span>
            </div>
        </div>

        <div class="formula-box">
            <div class="main">a √ó b = ‚àí(b √ó a)</div>
            <div class="explanation">Order matters! Switching the vectors reverses the result direction</div>
        </div>

        <!-- Magnitude: Area of Parallelogram -->
        <h2>The Magnitude: Area of the Parallelogram</h2>

        <div class="visual-container">
            <canvas id="areaCanvas" width="700" height="400"></canvas>
            <div class="controls">
                <div class="control-group">
                    <label>Angle between</label>
                    <input type="range" id="areaAngle" min="0" max="180" value="60">
                    <span class="value-display" id="areaAngleVal">60¬∞</span>
                </div>
                <div class="control-group">
                    <label>|a| length</label>
                    <input type="range" id="aMag" min="50" max="150" value="100">
                    <span class="value-display" id="aMagVal">1.00</span>
                </div>
                <div class="control-group">
                    <label>|b| length</label>
                    <input type="range" id="bMag" min="50" max="150" value="120">
                    <span class="value-display" id="bMagVal">1.20</span>
                </div>
            </div>
            <div class="result-display">
                <div class="cross-value" id="areaValue">Area = 1.04</div>
                <div class="direction-label">|a √ó b| = |a| |b| sin(Œ∏) = 1.00 √ó 1.20 √ó sin(60¬∞)</div>
            </div>
        </div>

        <div class="formula-box">
            <div class="main">|a √ó b| = |a| |b| sin(Œ∏)</div>
            <div class="explanation">The cross product magnitude equals the area of the parallelogram they span</div>
        </div>

        <div class="insight-box">
            <h4>COMPARE TO DOT PRODUCT</h4>
            <p><strong>Dot product</strong> uses cos(Œ∏) ‚Üí maximum when parallel, zero when perpendicular<br>
            <strong>Cross product</strong> uses sin(Œ∏) ‚Üí zero when parallel, maximum when perpendicular</p>
        </div>

        <!-- The Numerical Formula -->
        <h2>The Numerical Formula</h2>

        <p>When vectors are written as components, the cross product becomes a determinant:</p>

        <div class="determinant-box">
            <div class="matrix">
                <div class="matrix-row">
                    <span class="unit-vec">√Æ</span>
                    <span class="unit-vec">ƒµ</span>
                    <span class="unit-vec">kÃÇ</span>
                </div>
                <div class="matrix-row">
                    <span class="vec-a">a‚ÇÅ</span>
                    <span class="vec-a">a‚ÇÇ</span>
                    <span class="vec-a">a‚ÇÉ</span>
                </div>
                <div class="matrix-row">
                    <span class="vec-b">b‚ÇÅ</span>
                    <span class="vec-b">b‚ÇÇ</span>
                    <span class="vec-b">b‚ÇÉ</span>
                </div>
            </div>
        </div>

        <div class="formula-box">
            <div class="main">a √ó b = (a‚ÇÇb‚ÇÉ ‚àí a‚ÇÉb‚ÇÇ, a‚ÇÉb‚ÇÅ ‚àí a‚ÇÅb‚ÇÉ, a‚ÇÅb‚ÇÇ ‚àí a‚ÇÇb‚ÇÅ)</div>
            <div class="explanation">Each component is a 2√ó2 determinant from the other two coordinates</div>
        </div>

        <div class="visual-container">
            <canvas id="numCrossCanvas" width="700" height="350"></canvas>
            <div class="controls">
                <div class="control-group">
                    <label>a‚ÇÅ</label>
                    <input type="range" id="ca1" min="-100" max="100" value="100">
                    <span class="value-display" id="ca1Val">1.00</span>
                </div>
                <div class="control-group">
                    <label>a‚ÇÇ</label>
                    <input type="range" id="ca2" min="-100" max="100" value="0">
                    <span class="value-display" id="ca2Val">0.00</span>
                </div>
                <div class="control-group">
                    <label>b‚ÇÅ</label>
                    <input type="range" id="cb1" min="-100" max="100" value="0">
                    <span class="value-display" id="cb1Val">0.00</span>
                </div>
                <div class="control-group">
                    <label>b‚ÇÇ</label>
                    <input type="range" id="cb2" min="-100" max="100" value="100">
                    <span class="value-display" id="cb2Val">1.00</span>
                </div>
            </div>
            <div class="result-display">
                <div class="cross-value" id="numCrossResult">a √ó b = (0, 0, 1.00)</div>
                <div class="direction-label" id="numCrossExplain">√Æ √ó ƒµ = kÃÇ (x-axis crossed with y-axis gives z-axis)</div>
            </div>
        </div>

        <!-- Chemistry Examples -->
        <h2>Chemistry Applications</h2>

        <h3>1. Chirality: L vs D Forms</h3>

        <p>A chiral carbon has four different groups. The perpendicular direction determines handedness.</p>

        <div class="visual-container">
            <canvas id="chiralityCanvas" width="700" height="350"></canvas>
            <div class="controls">
                <div class="control-group">
                    <label>Mirror Plane</label>
                    <input type="range" id="mirrorPos" min="0" max="100" value="50">
                </div>
            </div>
            <div class="result-display">
                <div class="direction-label">The fourth group points perpendicular to the plane of the other three</div>
            </div>
        </div>

        <div class="insight-box">
            <h4>WHY THIS MATTERS</h4>
            <p>Your body only uses L-amino acids. The D-form of thalidomide caused birth defects while the L-form was therapeutic. Chirality is life-or-death chemistry.</p>
        </div>

        <h3>2. Torque: Rotational Force</h3>

        <div class="visual-container">
            <canvas id="torqueCanvas" width="700" height="350"></canvas>
            <div class="controls">
                <div class="control-group">
                    <label>Force Angle</label>
                    <input type="range" id="forceAngle" min="0" max="180" value="90">
                    <span class="value-display" id="forceAngleVal">90¬∞</span>
                </div>
            </div>
            <div class="result-display">
                <div class="cross-value" id="torqueValue">œÑ = r √ó F = 1.00</div>
                <div class="direction-label">Maximum torque when force is perpendicular to lever arm</div>
            </div>
        </div>

        <div class="formula-box">
            <div class="main">œÑ = r √ó F</div>
            <div class="explanation">Torque = (lever arm) √ó (force). Direction is the axis of rotation.</div>
        </div>

        <h3>3. Angular Momentum in Orbitals</h3>

        <div class="visual-container">
            <canvas id="angMomCanvas" width="700" height="350"></canvas>
            <div class="controls">
                <div class="control-group">
                    <label>Orbital Tilt</label>
                    <input type="range" id="orbitalTilt" min="0" max="90" value="45">
                    <span class="value-display" id="orbitalTiltVal">45¬∞</span>
                </div>
            </div>
            <div class="result-display">
                <div class="cross-value">L = r √ó p</div>
                <div class="direction-label">Angular momentum is perpendicular to the orbital plane</div>
            </div>
        </div>

        <!-- Special Cases -->
        <h2>Special Cases</h2>

        <div class="example-grid">
            <div class="example-card">
                <h4>Parallel Vectors (Œ∏ = 0¬∞)</h4>
                <canvas id="parallelCanvas" width="280" height="120"></canvas>
                <p>sin(0¬∞) = 0</p>
                <div class="result">a √ó b = 0 (zero vector)</div>
            </div>
            <div class="example-card">
                <h4>Perpendicular (Œ∏ = 90¬∞)</h4>
                <canvas id="perpCrossCanvas" width="280" height="120"></canvas>
                <p>sin(90¬∞) = 1</p>
                <div class="result">|a √ó b| = |a||b| (maximum)</div>
            </div>
        </div>

        <!-- Practice Problems -->
        <h2>Practice</h2>

        <div class="practice-section">
            <div class="problem">
                <div class="problem-question">
                    <strong>Problem 1:</strong> If a = (1, 0, 0) and b = (0, 1, 0), what is a √ó b?
                </div>
                <div class="problem-options">
                    <button class="option-btn" data-correct="true">(0, 0, 1)</button>
                    <button class="option-btn">(0, 0, -1)</button>
                    <button class="option-btn">(1, 1, 0)</button>
                    <button class="option-btn">(0, 0, 0)</button>
                </div>
                <div class="feedback" id="feedback1">
                    <strong>Correct!</strong> √Æ √ó ƒµ = kÃÇ. The x-axis crossed with the y-axis gives the positive z-axis (right-hand rule).
                </div>
            </div>

            <div class="problem">
                <div class="problem-question">
                    <strong>Problem 2:</strong> What is a √ó a for any vector a?
                </div>
                <div class="problem-options">
                    <button class="option-btn">|a|¬≤</button>
                    <button class="option-btn" data-correct="true">0 (zero vector)</button>
                    <button class="option-btn">a</button>
                    <button class="option-btn">2a</button>
                </div>
                <div class="feedback" id="feedback2">
                    <strong>Correct!</strong> A vector crossed with itself is zero because sin(0¬∞) = 0. There's no area in a "parallelogram" that's just a line.
                </div>
            </div>

            <div class="problem">
                <div class="problem-question">
                    <strong>Problem 3:</strong> If you push a door handle 0.8 m from the hinge with 10 N of force perpendicular to the door, what's the torque?
                </div>
                <div class="problem-options">
                    <button class="option-btn">0 N¬∑m</button>
                    <button class="option-btn">5 N¬∑m</button>
                    <button class="option-btn" data-correct="true">8 N¬∑m</button>
                    <button class="option-btn">10 N¬∑m</button>
                </div>
                <div class="feedback" id="feedback3">
                    <strong>Correct!</strong> œÑ = r √ó F = 0.8 √ó 10 √ó sin(90¬∞) = 8 N¬∑m. Perpendicular force gives maximum torque.
                </div>
            </div>

            <div class="problem">
                <div class="problem-question">
                    <strong>Problem 4:</strong> Why can't cross product exist in 2D?
                </div>
                <div class="problem-options">
                    <button class="option-btn">It requires complex numbers</button>
                    <button class="option-btn" data-correct="true">The result must be perpendicular to both inputs</button>
                    <button class="option-btn">2D vectors are too short</button>
                    <button class="option-btn">It does exist in 2D</button>
                </div>
                <div class="feedback" id="feedback4">
                    <strong>Correct!</strong> In 2D, the "perpendicular to both" direction would point out of the plane‚Äîa third dimension. This is why cross product is fundamentally a 3D operation.
                </div>
            </div>
        </div>

        <a href="sec7-addition.html" class="nav-link">Section 7: Combining Directions ‚Üí</a>
    </div>

    <script>
        // Helper: draw 3D-like arrow
        function drawArrow(ctx, x1, y1, x2, y2, color, width = 3) {
            const headLen = 12;
            const angle = Math.atan2(y2 - y1, x2 - x1);

            ctx.beginPath();
            ctx.moveTo(x1, y1);
            ctx.lineTo(x2, y2);
            ctx.strokeStyle = color;
            ctx.lineWidth = width;
            ctx.stroke();

            ctx.beginPath();
            ctx.moveTo(x2, y2);
            ctx.lineTo(x2 - headLen * Math.cos(angle - Math.PI/6), y2 - headLen * Math.sin(angle - Math.PI/6));
            ctx.lineTo(x2 - headLen * Math.cos(angle + Math.PI/6), y2 - headLen * Math.sin(angle + Math.PI/6));
            ctx.closePath();
            ctx.fillStyle = color;
            ctx.fill();
        }

        // Helper: draw 3D arrow (isometric projection)
        function draw3DArrow(ctx, cx, cy, v, color, width = 3) {
            // Isometric projection
            const isoX = 0.866 * v.x - 0.866 * v.y;
            const isoY = -0.5 * v.x - 0.5 * v.y + v.z;
            const scale = 80;

            drawArrow(ctx, cx, cy, cx + isoX * scale, cy - isoY * scale, color, width);
        }

        // === Main Cross Product Visualization ===
        const crossCanvas = document.getElementById('crossCanvas');
        const crossCtx = crossCanvas.getContext('2d');
        const aAngleSlider = document.getElementById('aAngle');
        const bAngleSlider = document.getElementById('bAngle');

        function drawCross() {
            const aAngle = parseFloat(aAngleSlider.value) * Math.PI / 180;
            const bAngle = parseFloat(bAngleSlider.value) * Math.PI / 180;

            crossCtx.fillStyle = '#0a0a0f';
            crossCtx.fillRect(0, 0, 700, 400);

            const cx = 350, cy = 250;

            // Vectors in XY plane
            const a = { x: Math.cos(aAngle), y: Math.sin(aAngle), z: 0 };
            const b = { x: Math.cos(bAngle), y: Math.sin(bAngle), z: 0 };

            // Cross product (a √ó b) = (0, 0, sin(angle_between))
            const crossZ = a.x * b.y - a.y * b.x;
            const crossMag = Math.abs(crossZ);

            // Draw grid (XY plane)
            crossCtx.strokeStyle = 'rgba(255,255,255,0.1)';
            crossCtx.lineWidth = 1;
            for (let i = -3; i <= 3; i++) {
                const offset = i * 40;
                crossCtx.beginPath();
                crossCtx.moveTo(cx + offset * 0.866, cy + offset * 0.5);
                crossCtx.lineTo(cx + offset * 0.866 - 240 * 0.866, cy + offset * 0.5 + 240 * 0.5);
                crossCtx.stroke();
                crossCtx.beginPath();
                crossCtx.moveTo(cx - offset * 0.866, cy + offset * 0.5);
                crossCtx.lineTo(cx - offset * 0.866 + 240 * 0.866, cy + offset * 0.5 + 240 * 0.5);
                crossCtx.stroke();
            }

            // Draw parallelogram (area representation)
            if (crossMag > 0.1) {
                crossCtx.beginPath();
                crossCtx.moveTo(cx, cy);
                const ax = a.x * 0.866 - a.y * 0.866;
                const ay = -a.x * 0.5 - a.y * 0.5;
                const bx = b.x * 0.866 - b.y * 0.866;
                const by = -b.x * 0.5 - b.y * 0.5;
                const scale = 80;
                crossCtx.lineTo(cx + ax * scale, cy + ay * scale);
                crossCtx.lineTo(cx + (ax + bx) * scale, cy + (ay + by) * scale);
                crossCtx.lineTo(cx + bx * scale, cy + by * scale);
                crossCtx.closePath();
                crossCtx.fillStyle = 'rgba(157, 122, 255, 0.2)';
                crossCtx.fill();
                crossCtx.strokeStyle = 'rgba(157, 122, 255, 0.5)';
                crossCtx.lineWidth = 2;
                crossCtx.stroke();
            }

            // Draw vectors
            draw3DArrow(crossCtx, cx, cy, a, '#4a9eff', 4);
            draw3DArrow(crossCtx, cx, cy, b, '#22d3ee', 4);

            // Draw cross product (pointing in Z)
            if (crossMag > 0.05) {
                const crossVec = { x: 0, y: 0, z: crossZ };
                draw3DArrow(crossCtx, cx, cy, crossVec, '#fb923c', 4);
            }

            // Labels
            crossCtx.font = '16px JetBrains Mono';
            crossCtx.fillStyle = '#4a9eff';
            const aLabelX = cx + (a.x * 0.866 - a.y * 0.866) * 90;
            const aLabelY = cy + (-a.x * 0.5 - a.y * 0.5) * 90;
            crossCtx.fillText('a', aLabelX + 10, aLabelY);

            crossCtx.fillStyle = '#22d3ee';
            const bLabelX = cx + (b.x * 0.866 - b.y * 0.866) * 90;
            const bLabelY = cy + (-b.x * 0.5 - b.y * 0.5) * 90;
            crossCtx.fillText('b', bLabelX + 10, bLabelY);

            if (crossMag > 0.05) {
                crossCtx.fillStyle = '#fb923c';
                crossCtx.fillText('a √ó b', cx + 10, cy - crossZ * 90);
            }

            // Update displays
            document.getElementById('aAngleVal').textContent = aAngleSlider.value + '¬∞';
            document.getElementById('bAngleVal').textContent = bAngleSlider.value + '¬∞';
            document.getElementById('crossMag').textContent = '|a √ó b| = ' + crossMag.toFixed(2);

            if (crossZ > 0.1) {
                document.getElementById('crossDir').textContent = 'a √ó b points out of the plane (toward you)';
            } else if (crossZ < -0.1) {
                document.getElementById('crossDir').textContent = 'a √ó b points into the plane (away from you)';
            } else {
                document.getElementById('crossDir').textContent = 'Vectors are parallel ‚Üí cross product is zero';
            }
        }

        aAngleSlider.addEventListener('input', drawCross);
        bAngleSlider.addEventListener('input', drawCross);
        drawCross();

        // === Right-Hand Rule Visualization ===
        const rhCanvas = document.getElementById('rightHandCanvas');
        const rhCtx = rhCanvas.getContext('2d');

        function drawRightHand() {
            rhCtx.fillStyle = '#0a0a0f';
            rhCtx.fillRect(0, 0, 700, 350);

            const cx = 350, cy = 200;

            // Draw coordinate system
            draw3DArrow(rhCtx, cx, cy, { x: 1.2, y: 0, z: 0 }, '#4a9eff', 4);
            draw3DArrow(rhCtx, cx, cy, { x: 0, y: 1.2, z: 0 }, '#22d3ee', 4);
            draw3DArrow(rhCtx, cx, cy, { x: 0, y: 0, z: 1.2 }, '#fb923c', 4);

            // Labels
            rhCtx.font = '18px JetBrains Mono';
            rhCtx.fillStyle = '#4a9eff';
            rhCtx.fillText('a (fingers)', cx + 110, cy + 55);
            rhCtx.fillStyle = '#22d3ee';
            rhCtx.fillText('b (curl)', cx - 130, cy + 55);
            rhCtx.fillStyle = '#fb923c';
            rhCtx.fillText('a √ó b (thumb)', cx + 10, cy - 100);

            // Curved arrow showing curl direction
            rhCtx.beginPath();
            rhCtx.arc(cx, cy, 50, 0.2, Math.PI - 0.2);
            rhCtx.strokeStyle = 'rgba(157, 122, 255, 0.5)';
            rhCtx.lineWidth = 2;
            rhCtx.stroke();

            // Arrow head on curve
            const curveEndX = cx + 50 * Math.cos(Math.PI - 0.2);
            const curveEndY = cy + 50 * Math.sin(Math.PI - 0.2);
            rhCtx.beginPath();
            rhCtx.moveTo(curveEndX, curveEndY);
            rhCtx.lineTo(curveEndX + 10, curveEndY - 5);
            rhCtx.lineTo(curveEndX + 5, curveEndY + 8);
            rhCtx.closePath();
            rhCtx.fillStyle = 'rgba(157, 122, 255, 0.7)';
            rhCtx.fill();
        }

        drawRightHand();

        // === Area/Parallelogram Visualization ===
        const areaCanvas = document.getElementById('areaCanvas');
        const areaCtx = areaCanvas.getContext('2d');
        const areaAngleSlider = document.getElementById('areaAngle');
        const aMagSlider = document.getElementById('aMag');
        const bMagSlider = document.getElementById('bMag');

        function drawArea() {
            const angle = parseFloat(areaAngleSlider.value) * Math.PI / 180;
            const aMag = parseFloat(aMagSlider.value);
            const bMag = parseFloat(bMagSlider.value);

            areaCtx.fillStyle = '#0a0a0f';
            areaCtx.fillRect(0, 0, 700, 400);

            const cx = 200, cy = 300;

            // Vector a (horizontal)
            const a = { x: aMag, y: 0 };
            // Vector b (at angle)
            const b = { x: bMag * Math.cos(angle), y: -bMag * Math.sin(angle) };

            // Draw parallelogram
            areaCtx.beginPath();
            areaCtx.moveTo(cx, cy);
            areaCtx.lineTo(cx + a.x, cy + a.y);
            areaCtx.lineTo(cx + a.x + b.x, cy + a.y + b.y);
            areaCtx.lineTo(cx + b.x, cy + b.y);
            areaCtx.closePath();
            areaCtx.fillStyle = 'rgba(157, 122, 255, 0.3)';
            areaCtx.fill();
            areaCtx.strokeStyle = '#9d7aff';
            areaCtx.lineWidth = 2;
            areaCtx.stroke();

            // Height line
            const height = bMag * Math.sin(angle);
            areaCtx.setLineDash([5, 5]);
            areaCtx.strokeStyle = 'rgba(251, 191, 36, 0.5)';
            areaCtx.beginPath();
            areaCtx.moveTo(cx + b.x, cy + b.y);
            areaCtx.lineTo(cx + b.x, cy);
            areaCtx.stroke();
            areaCtx.setLineDash([]);

            // Height label
            areaCtx.fillStyle = '#fbbf24';
            areaCtx.font = '14px JetBrains Mono';
            areaCtx.fillText('h = |b|sin(Œ∏)', cx + b.x + 10, cy + b.y/2);

            // Draw vectors
            drawArrow(areaCtx, cx, cy, cx + a.x, cy, '#4a9eff', 4);
            drawArrow(areaCtx, cx, cy, cx + b.x, cy + b.y, '#22d3ee', 4);

            // Angle arc
            areaCtx.beginPath();
            areaCtx.arc(cx, cy, 40, -angle, 0);
            areaCtx.strokeStyle = 'rgba(157, 122, 255, 0.5)';
            areaCtx.lineWidth = 2;
            areaCtx.stroke();
            areaCtx.fillStyle = '#9d7aff';
            areaCtx.font = '14px JetBrains Mono';
            areaCtx.fillText('Œ∏', cx + 50, cy - 15);

            // Labels
            areaCtx.fillStyle = '#4a9eff';
            areaCtx.font = '16px JetBrains Mono';
            areaCtx.fillText('a', cx + aMag/2, cy + 25);
            areaCtx.fillStyle = '#22d3ee';
            areaCtx.fillText('b', cx + b.x/2 - 20, cy + b.y/2);

            // Update displays
            document.getElementById('areaAngleVal').textContent = areaAngleSlider.value + '¬∞';
            document.getElementById('aMagVal').textContent = (aMag / 100).toFixed(2);
            document.getElementById('bMagVal').textContent = (bMag / 100).toFixed(2);

            const area = (aMag / 100) * (bMag / 100) * Math.sin(angle);
            document.getElementById('areaValue').textContent = 'Area = ' + area.toFixed(2);
        }

        [areaAngleSlider, aMagSlider, bMagSlider].forEach(s => s.addEventListener('input', drawArea));
        drawArea();

        // === Numerical Cross Product ===
        const numCrossCanvas = document.getElementById('numCrossCanvas');
        const numCrossCtx = numCrossCanvas.getContext('2d');
        const ca1 = document.getElementById('ca1');
        const ca2 = document.getElementById('ca2');
        const cb1 = document.getElementById('cb1');
        const cb2 = document.getElementById('cb2');

        function drawNumCross() {
            const a1 = parseFloat(ca1.value) / 100;
            const a2 = parseFloat(ca2.value) / 100;
            const b1 = parseFloat(cb1.value) / 100;
            const b2 = parseFloat(cb2.value) / 100;

            numCrossCtx.fillStyle = '#0a0a0f';
            numCrossCtx.fillRect(0, 0, 700, 350);

            const cx = 350, cy = 200;
            const scale = 120;

            // Grid
            numCrossCtx.strokeStyle = 'rgba(255,255,255,0.1)';
            numCrossCtx.lineWidth = 1;
            for (let i = -2; i <= 2; i++) {
                numCrossCtx.beginPath();
                numCrossCtx.moveTo(cx + i * 60, cy - 180);
                numCrossCtx.lineTo(cx + i * 60, cy + 120);
                numCrossCtx.stroke();
                numCrossCtx.beginPath();
                numCrossCtx.moveTo(cx - 180, cy + i * 60);
                numCrossCtx.lineTo(cx + 180, cy + i * 60);
                numCrossCtx.stroke();
            }

            // Draw vectors in 2D (XY plane view)
            drawArrow(numCrossCtx, cx, cy, cx + a1 * scale, cy - a2 * scale, '#4a9eff', 4);
            drawArrow(numCrossCtx, cx, cy, cx + b1 * scale, cy - b2 * scale, '#22d3ee', 4);

            // Cross product result (in Z direction, show as dot/cross symbol)
            const crossZ = a1 * b2 - a2 * b1;

            if (Math.abs(crossZ) > 0.05) {
                // Draw symbol indicating Z direction
                if (crossZ > 0) {
                    // Dot (coming toward you)
                    numCrossCtx.beginPath();
                    numCrossCtx.arc(cx, cy - 80, 15, 0, Math.PI * 2);
                    numCrossCtx.strokeStyle = '#fb923c';
                    numCrossCtx.lineWidth = 3;
                    numCrossCtx.stroke();
                    numCrossCtx.beginPath();
                    numCrossCtx.arc(cx, cy - 80, 4, 0, Math.PI * 2);
                    numCrossCtx.fillStyle = '#fb923c';
                    numCrossCtx.fill();
                    numCrossCtx.font = '12px JetBrains Mono';
                    numCrossCtx.fillText('a√ób (out)', cx + 25, cy - 75);
                } else {
                    // X (going away from you)
                    numCrossCtx.strokeStyle = '#fb923c';
                    numCrossCtx.lineWidth = 3;
                    numCrossCtx.beginPath();
                    numCrossCtx.arc(cx, cy - 80, 15, 0, Math.PI * 2);
                    numCrossCtx.stroke();
                    numCrossCtx.beginPath();
                    numCrossCtx.moveTo(cx - 8, cy - 88);
                    numCrossCtx.lineTo(cx + 8, cy - 72);
                    numCrossCtx.moveTo(cx + 8, cy - 88);
                    numCrossCtx.lineTo(cx - 8, cy - 72);
                    numCrossCtx.stroke();
                    numCrossCtx.fillStyle = '#fb923c';
                    numCrossCtx.font = '12px JetBrains Mono';
                    numCrossCtx.fillText('a√ób (in)', cx + 25, cy - 75);
                }
            }

            // Update displays
            document.getElementById('ca1Val').textContent = a1.toFixed(2);
            document.getElementById('ca2Val').textContent = a2.toFixed(2);
            document.getElementById('cb1Val').textContent = b1.toFixed(2);
            document.getElementById('cb2Val').textContent = b2.toFixed(2);

            document.getElementById('numCrossResult').textContent =
                'a √ó b = (0, 0, ' + crossZ.toFixed(2) + ')';

            if (Math.abs(crossZ) < 0.05) {
                document.getElementById('numCrossExplain').textContent = 'Vectors are parallel ‚Üí cross product is zero';
            } else if (crossZ > 0) {
                document.getElementById('numCrossExplain').textContent = 'Result points in +z direction (out of screen)';
            } else {
                document.getElementById('numCrossExplain').textContent = 'Result points in -z direction (into screen)';
            }
        }

        [ca1, ca2, cb1, cb2].forEach(s => s.addEventListener('input', drawNumCross));
        drawNumCross();

        // === Chirality Visualization ===
        const chiralCanvas = document.getElementById('chiralityCanvas');
        const chiralCtx = chiralCanvas.getContext('2d');
        const mirrorSlider = document.getElementById('mirrorPos');

        function drawChirality() {
            chiralCtx.fillStyle = '#0a0a0f';
            chiralCtx.fillRect(0, 0, 700, 350);

            const mirrorX = 350;

            // Draw mirror plane
            chiralCtx.strokeStyle = 'rgba(157, 122, 255, 0.5)';
            chiralCtx.lineWidth = 2;
            chiralCtx.setLineDash([10, 5]);
            chiralCtx.beginPath();
            chiralCtx.moveTo(mirrorX, 50);
            chiralCtx.lineTo(mirrorX, 300);
            chiralCtx.stroke();
            chiralCtx.setLineDash([]);
            chiralCtx.fillStyle = '#9d7aff';
            chiralCtx.font = '14px JetBrains Mono';
            chiralCtx.fillText('Mirror Plane', mirrorX - 50, 40);

            // L-form (left side)
            const lx = 175, ly = 180;
            drawTetrahedralCarbon(chiralCtx, lx, ly, false);
            chiralCtx.fillStyle = '#4a9eff';
            chiralCtx.font = '20px Fraunces';
            chiralCtx.fillText('L-form', lx - 35, ly + 100);

            // D-form (right side, mirror image)
            const dx = 525, dy = 180;
            drawTetrahedralCarbon(chiralCtx, dx, dy, true);
            chiralCtx.fillStyle = '#fb923c';
            chiralCtx.font = '20px Fraunces';
            chiralCtx.fillText('D-form', dx - 35, dy + 100);

            // Non-superimposable text
            chiralCtx.fillStyle = '#f87171';
            chiralCtx.font = '12px JetBrains Mono';
            chiralCtx.textAlign = 'center';
            chiralCtx.fillText('Non-superimposable mirror images', 350, 330);
            chiralCtx.textAlign = 'left';
        }

        function drawTetrahedralCarbon(ctx, cx, cy, mirror) {
            const scale = 50;
            const sign = mirror ? -1 : 1;

            // Central carbon
            ctx.beginPath();
            ctx.arc(cx, cy, 12, 0, Math.PI * 2);
            ctx.fillStyle = '#6b6966';
            ctx.fill();
            ctx.fillStyle = '#fff';
            ctx.font = '10px Inter';
            ctx.textAlign = 'center';
            ctx.fillText('C', cx, cy + 4);

            // Four different groups
            const groups = [
                { dx: -0.8 * sign, dy: -0.6, color: '#f87171', label: 'R' },
                { dx: 0.8 * sign, dy: -0.6, color: '#4ade80', label: 'H' },
                { dx: 0, dy: 0.8, color: '#fbbf24', label: 'X' },
                { dx: 0.5 * sign, dy: 0.2, color: '#22d3ee', label: 'Y', z: true }  // "out of plane"
            ];

            groups.forEach(g => {
                const gx = cx + g.dx * scale;
                const gy = cy + g.dy * scale;

                // Bond
                ctx.beginPath();
                ctx.moveTo(cx, cy);
                ctx.lineTo(gx, gy);
                ctx.strokeStyle = '#6b6966';
                ctx.lineWidth = g.z ? 4 : 2;
                ctx.stroke();

                // If wedge/dash
                if (g.z) {
                    // Wedge (bold/coming forward)
                    ctx.beginPath();
                    ctx.moveTo(cx, cy);
                    ctx.lineTo(gx - 5, gy - 5);
                    ctx.lineTo(gx + 5, gy + 5);
                    ctx.closePath();
                    ctx.fillStyle = '#6b6966';
                    ctx.fill();
                }

                // Group
                ctx.beginPath();
                ctx.arc(gx, gy, 15, 0, Math.PI * 2);
                ctx.fillStyle = g.color;
                ctx.fill();
                ctx.fillStyle = '#000';
                ctx.font = '12px Inter';
                ctx.fillText(g.label, gx, gy + 4);
            });

            ctx.textAlign = 'left';
        }

        mirrorSlider.addEventListener('input', drawChirality);
        drawChirality();

        // === Torque Visualization ===
        const torqueCanvas = document.getElementById('torqueCanvas');
        const torqueCtx = torqueCanvas.getContext('2d');
        const forceAngleSlider = document.getElementById('forceAngle');

        function drawTorque() {
            const angle = parseFloat(forceAngleSlider.value) * Math.PI / 180;

            torqueCtx.fillStyle = '#0a0a0f';
            torqueCtx.fillRect(0, 0, 700, 350);

            const pivotX = 200, pivotY = 175;
            const armLen = 150;

            // Pivot point
            torqueCtx.beginPath();
            torqueCtx.arc(pivotX, pivotY, 8, 0, Math.PI * 2);
            torqueCtx.fillStyle = '#6b6966';
            torqueCtx.fill();
            torqueCtx.fillStyle = '#9d7aff';
            torqueCtx.font = '14px JetBrains Mono';
            torqueCtx.fillText('pivot', pivotX - 20, pivotY + 25);

            // Lever arm (r)
            const armEndX = pivotX + armLen;
            const armEndY = pivotY;
            torqueCtx.strokeStyle = '#4a9eff';
            torqueCtx.lineWidth = 4;
            torqueCtx.beginPath();
            torqueCtx.moveTo(pivotX, pivotY);
            torqueCtx.lineTo(armEndX, armEndY);
            torqueCtx.stroke();
            torqueCtx.fillStyle = '#4a9eff';
            torqueCtx.fillText('r', pivotX + armLen/2, pivotY - 15);

            // Force (F)
            const forceLen = 80;
            const forceEndX = armEndX + forceLen * Math.cos(angle);
            const forceEndY = armEndY - forceLen * Math.sin(angle);
            drawArrow(torqueCtx, armEndX, armEndY, forceEndX, forceEndY, '#f87171', 4);
            torqueCtx.fillStyle = '#f87171';
            torqueCtx.fillText('F', forceEndX + 10, forceEndY);

            // Angle arc
            torqueCtx.beginPath();
            torqueCtx.arc(armEndX, armEndY, 30, -angle, 0);
            torqueCtx.strokeStyle = 'rgba(157, 122, 255, 0.5)';
            torqueCtx.lineWidth = 2;
            torqueCtx.stroke();

            // Torque indicator (circular arrow)
            const torqueMag = Math.sin(angle);
            if (torqueMag > 0.05) {
                torqueCtx.beginPath();
                torqueCtx.arc(pivotX, pivotY, 40, -0.5, -2.5, true);
                torqueCtx.strokeStyle = '#fb923c';
                torqueCtx.lineWidth = 3;
                torqueCtx.stroke();

                // Arrow head
                torqueCtx.beginPath();
                torqueCtx.moveTo(pivotX + 40 * Math.cos(-2.5), pivotY + 40 * Math.sin(-2.5));
                torqueCtx.lineTo(pivotX + 50 * Math.cos(-2.5) + 5, pivotY + 50 * Math.sin(-2.5));
                torqueCtx.lineTo(pivotX + 30 * Math.cos(-2.5) + 5, pivotY + 30 * Math.sin(-2.5));
                torqueCtx.closePath();
                torqueCtx.fillStyle = '#fb923c';
                torqueCtx.fill();

                torqueCtx.fillText('œÑ = r √ó F', pivotX - 70, pivotY);
            }

            // Update displays
            document.getElementById('forceAngleVal').textContent = forceAngleSlider.value + '¬∞';
            document.getElementById('torqueValue').textContent = 'œÑ = |r √ó F| = ' + torqueMag.toFixed(2);
        }

        forceAngleSlider.addEventListener('input', drawTorque);
        drawTorque();

        // === Angular Momentum Visualization ===
        const angMomCanvas = document.getElementById('angMomCanvas');
        const angMomCtx = angMomCanvas.getContext('2d');
        const orbitalTiltSlider = document.getElementById('orbitalTilt');

        function drawAngMom() {
            const tilt = parseFloat(orbitalTiltSlider.value) * Math.PI / 180;

            angMomCtx.fillStyle = '#0a0a0f';
            angMomCtx.fillRect(0, 0, 700, 350);

            const cx = 350, cy = 200;
            const orbitRadius = 100;

            // Draw tilted orbital ellipse
            angMomCtx.save();
            angMomCtx.translate(cx, cy);
            angMomCtx.rotate(tilt);

            // Orbital path
            angMomCtx.beginPath();
            angMomCtx.ellipse(0, 0, orbitRadius, orbitRadius * 0.3, 0, 0, Math.PI * 2);
            angMomCtx.strokeStyle = 'rgba(74, 158, 255, 0.5)';
            angMomCtx.lineWidth = 2;
            angMomCtx.stroke();

            // Electron
            const electronAngle = Date.now() / 500;
            const ex = orbitRadius * Math.cos(electronAngle);
            const ey = orbitRadius * 0.3 * Math.sin(electronAngle);
            angMomCtx.beginPath();
            angMomCtx.arc(ex, ey, 8, 0, Math.PI * 2);
            angMomCtx.fillStyle = '#4a9eff';
            angMomCtx.fill();

            // Position vector r
            angMomCtx.strokeStyle = '#22d3ee';
            angMomCtx.lineWidth = 2;
            angMomCtx.beginPath();
            angMomCtx.moveTo(0, 0);
            angMomCtx.lineTo(ex, ey);
            angMomCtx.stroke();

            // Velocity vector p (tangent)
            const vx = -orbitRadius * Math.sin(electronAngle) * 0.3;
            const vy = orbitRadius * 0.3 * Math.cos(electronAngle) * 0.3;
            drawArrow(angMomCtx, ex, ey, ex + vx, ey + vy, '#4ade80', 2);

            angMomCtx.restore();

            // Angular momentum vector (perpendicular to orbital plane)
            const Lx = 0;
            const Ly = -80 * Math.cos(tilt);
            const Lz = 80 * Math.sin(tilt);  // not visible in 2D but affects position
            drawArrow(angMomCtx, cx, cy, cx + Lx, cy + Ly, '#fb923c', 4);

            // Labels
            angMomCtx.fillStyle = '#fb923c';
            angMomCtx.font = '16px JetBrains Mono';
            angMomCtx.fillText('L', cx + 10, cy + Ly - 10);

            angMomCtx.fillStyle = '#6b6966';
            angMomCtx.beginPath();
            angMomCtx.arc(cx, cy, 6, 0, Math.PI * 2);
            angMomCtx.fill();
            angMomCtx.fillStyle = '#9d7aff';
            angMomCtx.font = '12px JetBrains Mono';
            angMomCtx.fillText('nucleus', cx - 25, cy + 20);

            // Update displays
            document.getElementById('orbitalTiltVal').textContent = orbitalTiltSlider.value + '¬∞';

            requestAnimationFrame(drawAngMom);
        }

        orbitalTiltSlider.addEventListener('input', () => {});  // Animation handles updates
        drawAngMom();

        // === Special Cases ===
        function drawParallel() {
            const canvas = document.getElementById('parallelCanvas');
            const ctx = canvas.getContext('2d');
            ctx.fillStyle = '#12121a';
            ctx.fillRect(0, 0, 280, 120);

            const cx = 60, cy = 60;
            drawArrow(ctx, cx, cy, cx + 60, cy, '#4a9eff', 3);
            drawArrow(ctx, cx, cy, cx + 80, cy, '#22d3ee', 3);
        }

        function drawPerpCross() {
            const canvas = document.getElementById('perpCrossCanvas');
            const ctx = canvas.getContext('2d');
            ctx.fillStyle = '#12121a';
            ctx.fillRect(0, 0, 280, 120);

            const cx = 80, cy = 80;
            drawArrow(ctx, cx, cy, cx + 60, cy, '#4a9eff', 3);
            drawArrow(ctx, cx, cy, cx, cy - 60, '#22d3ee', 3);

            // Cross product indicator (dot)
            ctx.beginPath();
            ctx.arc(cx + 20, cy - 20, 8, 0, Math.PI * 2);
            ctx.strokeStyle = '#fb923c';
            ctx.lineWidth = 2;
            ctx.stroke();
            ctx.beginPath();
            ctx.arc(cx + 20, cy - 20, 3, 0, Math.PI * 2);
            ctx.fillStyle = '#fb923c';
            ctx.fill();
        }

        drawParallel();
        drawPerpCross();

        // === Causal Chain Interaction ===
        document.querySelectorAll('.chain-step').forEach(step => {
            step.addEventListener('click', () => {
                document.querySelectorAll('.chain-step').forEach(s => s.classList.remove('active'));
                step.classList.add('active');
            });
        });

        // === Practice Problems ===
        document.querySelectorAll('.problem-options').forEach((options, i) => {
            const feedback = document.getElementById('feedback' + (i + 1));
            options.querySelectorAll('.option-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const isCorrect = btn.dataset.correct === 'true';

                    options.querySelectorAll('.option-btn').forEach(b => {
                        b.disabled = true;
                        if (b.dataset.correct === 'true') b.classList.add('correct');
                        else if (b === btn && !isCorrect) b.classList.add('incorrect');
                    });

                    feedback.classList.add('show');
                    feedback.classList.add(isCorrect ? 'correct' : 'incorrect');
                    if (!isCorrect) {
                        feedback.innerHTML = '<strong>Not quite.</strong> ' + feedback.innerHTML.split('</strong>')[1];
                    }
                });
            });
        });
    </script>
</body>
</html>
