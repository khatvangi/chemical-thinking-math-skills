<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lecture 5: Angles and Projections | Chemical Thinking</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,400;9..144,600;9..144,700&family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
  <style>
    :root {
      --bg-primary: #0a0a0f;
      --bg-secondary: #12121a;
      --bg-tertiary: #1a1a24;
      --text-primary: #e8e6e3;
      --text-secondary: #a8a5a0;
      --text-muted: #6b6965;
      --accent-gold: #d4a574;
      --accent-purple: #9d8cff;
      --accent-cyan: #6bcfcf;
      --accent-coral: #e07a5f;
      --accent-green: #81b29a;
      --border-subtle: #2a2a35;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Inter', system-ui, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.7;
      font-size: 17px;
    }

    .container { max-width: 900px; margin: 0 auto; padding: 2rem; }

    header {
      border-bottom: 1px solid var(--border-subtle);
      padding: 3rem 0;
      margin-bottom: 3rem;
    }

    .lecture-number {
      font-family: 'JetBrains Mono', monospace;
      color: var(--accent-purple);
      font-size: 0.9rem;
      letter-spacing: 0.1em;
      margin-bottom: 0.5rem;
    }

    .lecture-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 1.5rem;
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: 12px;
      margin-bottom: 3rem;
    }

    .nav-link {
      color: var(--text-secondary);
      text-decoration: none;
      font-size: 0.9rem;
      transition: color 0.2s;
    }

    .nav-link:hover { color: var(--accent-cyan); }

    .primitive-link {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      text-decoration: none;
      padding: 0.5rem 1rem;
      background: linear-gradient(135deg, rgba(129, 178, 154, 0.1), rgba(129, 178, 154, 0.05));
      border: 1px solid var(--accent-green);
      border-radius: 8px;
      transition: all 0.2s;
    }

    .primitive-link:hover {
      background: linear-gradient(135deg, rgba(129, 178, 154, 0.2), rgba(129, 178, 154, 0.1));
      transform: translateX(3px);
    }

    .primitive-badge {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--accent-green);
      letter-spacing: 0.05em;
    }

    .primitive-text {
      font-size: 0.85rem;
      color: var(--text-secondary);
    }

    h1 {
      font-family: 'Fraunces', serif;
      font-size: 2.8rem;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 0.75rem;
    }

    .subtitle {
      font-size: 1.2rem;
      color: var(--text-secondary);
      font-style: italic;
    }

    section { margin-bottom: 4rem; }

    h2 {
      font-family: 'Fraunces', serif;
      font-size: 1.8rem;
      font-weight: 600;
      color: var(--accent-gold);
      margin-bottom: 1.5rem;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid var(--border-subtle);
    }

    h3 {
      font-family: 'Fraunces', serif;
      font-size: 1.3rem;
      font-weight: 600;
      color: var(--text-primary);
      margin: 2rem 0 1rem;
    }

    h4 {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--accent-cyan);
      margin: 1.5rem 0 0.75rem;
    }

    p { margin-bottom: 1.25rem; color: var(--text-secondary); }
    strong { color: var(--text-primary); font-weight: 600; }

    .hook-box {
      background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);
      border: 1px solid var(--accent-gold);
      border-radius: 12px;
      padding: 2rem;
      margin: 2rem 0;
    }

    .hook-box p {
      font-size: 1.15rem;
      color: var(--text-primary);
      margin-bottom: 1rem;
    }

    .hook-box p:last-child { margin-bottom: 0; }

    .definition-box {
      background: var(--bg-secondary);
      border-left: 4px solid var(--accent-purple);
      padding: 1.5rem;
      margin: 1.5rem 0;
      border-radius: 0 8px 8px 0;
    }

    .definition-box .label, .theorem-box .label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.75rem;
    }

    .definition-box .label { color: var(--accent-purple); }

    .theorem-box {
      background: var(--bg-secondary);
      border-left: 4px solid var(--accent-green);
      padding: 1.5rem;
      margin: 1.5rem 0;
      border-radius: 0 8px 8px 0;
    }

    .theorem-box .label { color: var(--accent-green); }

    .table-container { overflow-x: auto; margin: 1.5rem 0; }

    table { width: 100%; border-collapse: collapse; font-size: 0.95rem; }

    th {
      background: var(--bg-tertiary);
      color: var(--accent-gold);
      font-weight: 600;
      text-align: left;
      padding: 1rem;
      border-bottom: 2px solid var(--border-subtle);
    }

    td {
      padding: 0.875rem 1rem;
      border-bottom: 1px solid var(--border-subtle);
      color: var(--text-secondary);
    }

    tr:hover td { background: var(--bg-secondary); }

    .math-block {
      background: var(--bg-secondary);
      padding: 1.5rem;
      border-radius: 8px;
      margin: 1.5rem 0;
      overflow-x: auto;
      text-align: center;
    }

    code {
      font-family: 'JetBrains Mono', monospace;
      background: var(--bg-tertiary);
      padding: 0.2em 0.4em;
      border-radius: 4px;
      font-size: 0.9em;
      color: var(--accent-coral);
    }

    ul, ol { margin: 1rem 0 1.5rem 1.5rem; color: var(--text-secondary); }
    li { margin-bottom: 0.5rem; }

    .visual-container {
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: 12px;
      padding: 1.5rem;
      margin: 2rem 0;
    }

    .visual-container h4 { margin-top: 0; color: var(--accent-cyan); }

    .visual-controls {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid var(--border-subtle);
    }

    .control-group { display: flex; flex-direction: column; gap: 0.25rem; }
    .control-group label { font-size: 0.85rem; color: var(--text-muted); }
    .control-group input[type="range"] { width: 150px; accent-color: var(--accent-purple); }

    canvas { display: block; margin: 0 auto; border-radius: 8px; }

    .visual-info {
      display: flex;
      flex-wrap: wrap;
      gap: 1.5rem;
      margin-top: 1rem;
      padding: 1rem;
      background: var(--bg-tertiary);
      border-radius: 8px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
    }

    .info-item { display: flex; flex-direction: column; gap: 0.25rem; }

    .info-item .label {
      font-size: 0.75rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .info-item .value { color: var(--accent-cyan); }

    .example-box {
      background: var(--bg-tertiary);
      border: 1px solid var(--border-subtle);
      border-radius: 8px;
      padding: 1.5rem;
      margin: 1.5rem 0;
    }

    .example-box .example-label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      color: var(--accent-coral);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.75rem;
    }

    .proof-box {
      background: var(--bg-secondary);
      border: 1px dashed var(--border-subtle);
      border-radius: 8px;
      padding: 1.5rem;
      margin: 1.5rem 0;
    }

    .proof-box .proof-label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.75rem;
    }

    .qed { text-align: right; color: var(--accent-green); font-weight: bold; }

    .summary-box {
      background: linear-gradient(135deg, rgba(157, 140, 255, 0.1) 0%, rgba(107, 207, 207, 0.1) 100%);
      border: 1px solid var(--accent-purple);
      border-radius: 12px;
      padding: 2rem;
      margin: 2rem 0;
    }

    .summary-box h3 { color: var(--accent-purple); margin-top: 0; }

    .exercise {
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: 8px;
      padding: 1.5rem;
      margin: 1.5rem 0;
    }

    .exercise-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .exercise-number {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
      color: var(--accent-gold);
    }

    .solution-toggle {
      background: var(--bg-tertiary);
      border: 1px solid var(--border-subtle);
      color: var(--text-secondary);
      padding: 0.5rem 1rem;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.85rem;
      transition: all 0.2s;
    }

    .solution-toggle:hover { background: var(--accent-purple); color: var(--bg-primary); }

    .solution {
      display: none;
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px dashed var(--border-subtle);
    }

    .solution.show { display: block; }

    .solution-label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      color: var(--accent-green);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.75rem;
    }

    .nav-footer {
      display: flex;
      justify-content: space-between;
      margin-top: 4rem;
      padding-top: 2rem;
      border-top: 1px solid var(--border-subtle);
    }

    .nav-link {
      color: var(--accent-purple);
      text-decoration: none;
      font-size: 0.95rem;
      transition: color 0.2s;
    }

    .nav-link:hover { color: var(--accent-cyan); }

    .recognition-tag {
      display: inline-block;
      background: var(--accent-purple);
      color: var(--bg-primary);
      padding: 0.25rem 0.75rem;
      border-radius: 4px;
      font-size: 0.85rem;
      font-weight: 600;
      margin-bottom: 1rem;
    }

    .properties-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1rem;
      margin: 1.5rem 0;
    }

    .property-card {
      background: var(--bg-tertiary);
      padding: 1rem;
      border-radius: 8px;
      border: 1px solid var(--border-subtle);
    }

    .property-card .property-name { font-weight: 600; color: var(--accent-gold); margin-bottom: 0.5rem; }
    .property-card .property-formula { font-family: 'JetBrains Mono', monospace; color: var(--accent-cyan); }

    @media (max-width: 768px) {
      .container { padding: 1rem; }
      h1 { font-size: 2rem; }
      h2 { font-size: 1.5rem; }
      .visual-controls { flex-direction: column; }
      canvas { max-width: 100%; height: auto; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="lecture-number">LECTURE 05</div>
      <h1>Angles and Projections</h1>
      <p class="subtitle">The dot product: measuring alignment between directions.</p>
    </header>

    <nav class="lecture-nav">
      <a href="../all-lectures.html" class="nav-link">← All Lectures</a>
      <a href="../../primitives/direction.html" class="primitive-link">
        <span class="primitive-badge">DIRECTION</span>
        <span class="primitive-text">Explore the Primitive →</span>
      </a>
    </nav>

    <section>
      <h2>The Hook</h2>
      <div class="hook-box">
        <p>You have two bond vectors in a molecule. You can compute their lengths (Lecture 4).</p>
        <p>But now you want to know: <strong>What is the angle between them?</strong></p>
        <p>Or: <strong>How much does one vector point in the direction of another?</strong></p>
        <p>These questions require a new operation: the <strong>dot product</strong>.</p>
      </div>

      <div class="visual-container">
        <h4>Two Bond Vectors in Water</h4>
        <canvas id="bondVectorsCanvas" width="600" height="300"></canvas>
        <div class="visual-info">
          <div class="info-item">
            <span class="label">O-H1 vector</span>
            <span class="value">b1 = (0.958, 0, 0)</span>
          </div>
          <div class="info-item">
            <span class="label">O-H2 vector</span>
            <span class="value">b2 = (-0.240, 0.927, 0)</span>
          </div>
          <div class="info-item">
            <span class="label">Angle</span>
            <span class="value">104.5 deg</span>
          </div>
        </div>
      </div>
    </section>

    <section>
      <h2>Recognition</h2>
      <span class="recognition-tag">DIRECTION (continued)</span>
      <p style="font-size: 1.1rem; color: var(--text-primary);">"It points."</p>
      <p>The dot product answers questions about <strong>relative direction</strong>:</p>
      <ul>
        <li>Are two vectors parallel? Perpendicular? At some other angle?</li>
        <li>How much of one vector lies along another?</li>
        <li>What is the "component" of a force in a given direction?</li>
      </ul>
    </section>

    <section>
      <h2>When to Use the Dot Product</h2>
      <div class="table-container">
        <table>
          <thead>
            <tr><th>Question</th><th>Dot product gives you</th></tr>
          </thead>
          <tbody>
            <tr><td>"What's the angle between these two directions?"</td><td><code>theta = arccos(v.w / |v||w|)</code></td></tr>
            <tr><td>"Are these perpendicular?"</td><td>Yes if <code>v.w = 0</code></td></tr>
            <tr><td>"Are these parallel?"</td><td>Yes if <code>v.w = +/-|v||w|</code></td></tr>
            <tr><td>"How much of v points along w?"</td><td>Projection: <code>(v.w)/|w|</code></td></tr>
            <tr><td>"What's the work done by a force?"</td><td><code>W = F.d</code></td></tr>
          </tbody>
        </table>
      </div>
      <p><strong>Key insight:</strong> The dot product measures <strong>alignment</strong> between vectors.</p>
    </section>

    <section>
      <h2>The Dot Product: Two Definitions</h2>

      <h3>Definition 1 (Geometric)</h3>
      <div class="definition-box">
        <div class="label">Definition</div>
        <p>For vectors <strong>v</strong> and <strong>w</strong>, the <strong>dot product</strong> is:</p>
        <div class="math-block">$$\mathbf{v} \cdot \mathbf{w} = |\mathbf{v}||\mathbf{w}|\cos\theta$$</div>
        <p>where theta is the angle between the vectors.</p>
      </div>

      <ul>
        <li><strong>theta = 0</strong> (parallel, same direction): v.w = |v||w| (maximum positive)</li>
        <li><strong>theta = 90 deg</strong> (perpendicular): v.w = 0</li>
        <li><strong>theta = 180 deg</strong> (parallel, opposite): v.w = -|v||w| (maximum negative)</li>
      </ul>

      <h3>Definition 2 (Algebraic)</h3>
      <div class="definition-box">
        <div class="label">Definition</div>
        <p>For vectors <strong>v</strong> = (v1, v2, ..., vn) and <strong>w</strong> = (w1, w2, ..., wn):</p>
        <div class="math-block">$$\mathbf{v} \cdot \mathbf{w} = v_1 w_1 + v_2 w_2 + \cdots + v_n w_n = \sum_{i=1}^{n} v_i w_i$$</div>
      </div>

      <div class="example-box">
        <div class="example-label">Example</div>
        <p><strong>v</strong> = (3, -1, 2), <strong>w</strong> = (1, 4, -1)</p>
        <p>v.w = (3)(1) + (-1)(4) + (2)(-1) = 3 - 4 - 2 = <strong>-3</strong></p>
        <p>The negative value tells us the vectors point "mostly away" from each other.</p>
      </div>

      <div class="theorem-box">
        <div class="label">Theorem</div>
        <p>The geometric and algebraic definitions are equivalent.</p>
      </div>
    </section>

    <section>
      <h2>Properties of the Dot Product</h2>
      <div class="properties-grid">
        <div class="property-card">
          <div class="property-name">1. Commutative</div>
          <div class="property-formula">v.w = w.v</div>
        </div>
        <div class="property-card">
          <div class="property-name">2. Distributive</div>
          <div class="property-formula">u.(v + w) = u.v + u.w</div>
        </div>
        <div class="property-card">
          <div class="property-name">3. Scalar multiplication</div>
          <div class="property-formula">(cv).w = c(v.w)</div>
        </div>
        <div class="property-card">
          <div class="property-name">4. Self dot product</div>
          <div class="property-formula">v.v = |v|^2</div>
        </div>
      </div>
      <p>Property 4 is particularly useful: <strong>|v| = sqrt(v.v)</strong></p>
    </section>

    <section>
      <h2>Computing Angles</h2>
      <div class="definition-box">
        <div class="label">The Angle Formula</div>
        <div class="math-block">$$\theta = \arccos\left(\frac{\mathbf{v} \cdot \mathbf{w}}{|\mathbf{v}||\mathbf{w}|}\right)$$</div>
      </div>

      <div class="example-box">
        <div class="example-label">Example: Water bond angle</div>
        <p>O-H1: <strong>b</strong>1 = (0.958, 0, 0), O-H2: <strong>b</strong>2 = (-0.240, 0.927, 0)</p>
        <p>b1.b2 = -0.230, |b1| = |b2| = 0.958</p>
        <p>cos theta = -0.230 / 0.918 = -0.251</p>
        <p>theta = arccos(-0.251) = <strong>104.5 deg</strong></p>
      </div>

      <div class="example-box">
        <div class="example-label">Example: Tetrahedral angle (Methane)</div>
        <p><strong>b</strong>1 = (1, 1, 1)/sqrt(3), <strong>b</strong>2 = (1, -1, -1)/sqrt(3)</p>
        <p>b1.b2 = -1/3, theta = arccos(-1/3) = <strong>109.47 deg</strong></p>
      </div>
    </section>

    <section>
      <h2>Orthogonality</h2>
      <div class="definition-box">
        <div class="label">Definition</div>
        <p>Vectors <strong>v</strong> and <strong>w</strong> are <strong>orthogonal</strong> (perpendicular) if v.w = 0.</p>
      </div>

      <div class="visual-container">
        <h4>Orthogonality Tester</h4>
        <canvas id="orthogonalityCanvas" width="500" height="400"></canvas>
        <div class="visual-controls">
          <div class="control-group">
            <label>Rotate vector w</label>
            <input type="range" id="rotateW" min="0" max="360" value="90">
          </div>
        </div>
        <div class="visual-info">
          <div class="info-item">
            <span class="label">v.w</span>
            <span class="value" id="dotProductValue">0.00</span>
          </div>
          <div class="info-item">
            <span class="label">Angle</span>
            <span class="value" id="angleValue">90.0 deg</span>
          </div>
          <div class="info-item">
            <span class="label">Relationship</span>
            <span class="value" id="relationshipValue">Perpendicular</span>
          </div>
        </div>
      </div>
    </section>

    <section>
      <h2>Projection</h2>
      <p><strong>The projection problem:</strong> Find the component of <strong>v</strong> in the direction of <strong>w</strong>.</p>

      <h3>Scalar Projection</h3>
      <div class="definition-box">
        <div class="label">Definition</div>
        <div class="math-block">$$\text{comp}_{\mathbf{w}} \mathbf{v} = \frac{\mathbf{v} \cdot \mathbf{w}}{|\mathbf{w}|} = |\mathbf{v}|\cos\theta$$</div>
      </div>

      <h3>Vector Projection</h3>
      <div class="definition-box">
        <div class="label">Definition</div>
        <div class="math-block">$$\text{proj}_{\mathbf{w}} \mathbf{v} = \frac{\mathbf{v} \cdot \mathbf{w}}{\mathbf{w} \cdot \mathbf{w}} \mathbf{w}$$</div>
      </div>

      <div class="visual-container">
        <h4>Projection Visualizer</h4>
        <canvas id="projectionCanvas" width="600" height="400"></canvas>
        <div class="visual-controls">
          <div class="control-group">
            <label>Vector v angle</label>
            <input type="range" id="vAngle" min="0" max="180" value="45">
          </div>
          <div class="control-group">
            <label>|v| magnitude</label>
            <input type="range" id="vMagnitude" min="50" max="200" value="150">
          </div>
        </div>
        <div class="visual-info">
          <div class="info-item">
            <span class="label">v</span>
            <span class="value" id="projVectorV">(106, 106)</span>
          </div>
          <div class="info-item">
            <span class="label">proj_w v</span>
            <span class="value" id="projVectorProj">(106, 0)</span>
          </div>
          <div class="info-item">
            <span class="label">v_perp</span>
            <span class="value" id="projVectorPerp">(0, 106)</span>
          </div>
        </div>
      </div>

      <h3>Orthogonal Decomposition</h3>
      <div class="math-block">$$\mathbf{v} = \text{proj}_{\mathbf{w}} \mathbf{v} + \mathbf{v}_\perp$$</div>
    </section>

    <section>
      <h2>Chemistry Connection: Bond Angles</h2>
      <div class="definition-box">
        <div class="label">Bond Angle Algorithm</div>
        <ol>
          <li>Compute bond vectors: <strong>b</strong>1 = <strong>r</strong>_A - <strong>r</strong>_B, <strong>b</strong>2 = <strong>r</strong>_C - <strong>r</strong>_B</li>
          <li>Compute dot product: <strong>b</strong>1.<strong>b</strong>2</li>
          <li>Compute magnitudes: |<strong>b</strong>1|, |<strong>b</strong>2|</li>
          <li>Apply: theta = arccos(<strong>b</strong>1.<strong>b</strong>2 / |<strong>b</strong>1||<strong>b</strong>2|)</li>
        </ol>
      </div>

      <div class="visual-container">
        <h4>Bond Angle Calculator</h4>
        <canvas id="bondAngleCanvas" width="600" height="350"></canvas>
        <div class="visual-controls">
          <div class="control-group">
            <label>Molecule</label>
            <select id="moleculeSelect" style="background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-subtle); padding: 0.5rem; border-radius: 4px;">
              <option value="water">H2O (Water) - 104.5 deg</option>
              <option value="methane">CH4 (Methane) - 109.5 deg</option>
              <option value="ammonia">NH3 (Ammonia) - 107 deg</option>
              <option value="co2">CO2 (Linear) - 180 deg</option>
              <option value="bf3">BF3 (Trigonal) - 120 deg</option>
            </select>
          </div>
        </div>
        <div class="visual-info">
          <div class="info-item">
            <span class="label">Bond 1</span>
            <span class="value" id="bond1Vector">b1 = (0.96, 0.00, 0.00)</span>
          </div>
          <div class="info-item">
            <span class="label">Bond 2</span>
            <span class="value" id="bond2Vector">b2 = (-0.24, 0.93, 0.00)</span>
          </div>
          <div class="info-item">
            <span class="label">b1.b2</span>
            <span class="value" id="bondDotProduct">-0.230</span>
          </div>
          <div class="info-item">
            <span class="label">Angle</span>
            <span class="value" id="calculatedBondAngle">104.5 deg</span>
          </div>
        </div>
      </div>
    </section>

    <section>
      <h2>Chemistry Connection: Work and Energy</h2>
      <div class="definition-box">
        <div class="label">Work as Dot Product</div>
        <div class="math-block">$$W = \mathbf{F} \cdot \mathbf{d} = |\mathbf{F}||\mathbf{d}|\cos\theta$$</div>
      </div>
      <ul>
        <li>Only the component of force <strong>along</strong> the displacement does work</li>
        <li>Force perpendicular to motion does no work</li>
        <li>Force opposing motion does negative work</li>
      </ul>

      <h3>Dipole-Field Interaction</h3>
      <div class="math-block">$$U = -\boldsymbol{\mu} \cdot \mathbf{E}$$</div>
      <p>Minimum energy when dipole aligned with field (theta = 0).</p>
    </section>

    <section>
      <h2>Summary</h2>
      <div class="summary-box">
        <h3>The Dot Product Toolkit</h3>
        <div class="table-container">
          <table>
            <thead><tr><th>I want to...</th><th>Formula</th></tr></thead>
            <tbody>
              <tr><td>Find angle between vectors</td><td><code>theta = arccos(v.w / |v||w|)</code></td></tr>
              <tr><td>Check if perpendicular</td><td>Test if <code>v.w = 0</code></td></tr>
              <tr><td>Find length of vector</td><td><code>|v| = sqrt(v.v)</code></td></tr>
              <tr><td>Project v onto w</td><td><code>proj_w v = (v.w / w.w) w</code></td></tr>
              <tr><td>Compute work</td><td><code>W = F.d</code></td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <section>
      <h2>Exercises</h2>

      <div class="exercise">
        <div class="exercise-header">
          <span class="exercise-number">Exercise 1: Basic Dot Products</span>
          <button class="solution-toggle" onclick="toggleSolution('sol1')">Show Solution</button>
        </div>
        <p>Compute v.w: (a) v=(2,3), w=(4,-1) (b) v=(1,0,0), w=(0,1,0) (c) v=(1,1,1), w=(1,1,1)</p>
        <div id="sol1" class="solution">
          <div class="solution-label">Solution</div>
          <p>(a) 8-3 = <strong>5</strong> (b) <strong>0</strong> (perpendicular) (c) <strong>3</strong></p>
        </div>
      </div>

      <div class="exercise">
        <div class="exercise-header">
          <span class="exercise-number">Exercise 2: Angles</span>
          <button class="solution-toggle" onclick="toggleSolution('sol2')">Show Solution</button>
        </div>
        <p>Find the angle between: (a) v=(1,0), w=(1,1) (b) v=(3,4), w=(-4,3)</p>
        <div id="sol2" class="solution">
          <div class="solution-label">Solution</div>
          <p>(a) cos theta = 1/sqrt(2), theta = <strong>45 deg</strong> (b) v.w = 0, theta = <strong>90 deg</strong></p>
        </div>
      </div>

      <div class="exercise">
        <div class="exercise-header">
          <span class="exercise-number">Exercise 3: Projection</span>
          <button class="solution-toggle" onclick="toggleSolution('sol3')">Show Solution</button>
        </div>
        <p>Project v = (4, 3) onto w = (1, 1). Find the perpendicular component.</p>
        <div id="sol3" class="solution">
          <div class="solution-label">Solution</div>
          <p>v.w = 7, w.w = 2, proj = (7/2)(1,1) = <strong>(3.5, 3.5)</strong></p>
          <p>v_perp = (4,3) - (3.5,3.5) = <strong>(0.5, -0.5)</strong></p>
        </div>
      </div>

      <div class="exercise">
        <div class="exercise-header">
          <span class="exercise-number">Exercise 4: Work</span>
          <button class="solution-toggle" onclick="toggleSolution('sol4')">Show Solution</button>
        </div>
        <p>Force F = (10, -5, 2) N acts as particle moves from (1,2,3) to (4,1,5) m. Find the work.</p>
        <div id="sol4" class="solution">
          <div class="solution-label">Solution</div>
          <p>d = (3, -1, 2), W = F.d = 30 + 5 + 4 = <strong>39 J</strong></p>
        </div>
      </div>
    </section>

    <nav class="nav-footer">
      <a href="../04-direction/" class="nav-link">Lecture 4: Bonds Point</a>
      <a href="../" class="nav-link">All Lectures</a>
      <a href="../06-coordinates/" class="nav-link">Lecture 6: Coordinates</a>
    </nav>

    <footer style="text-align: center; padding: 3rem 0; color: var(--text-muted); font-size: 0.9rem;">
      <p><em>Chemical Thinking: The Grammar of Reality</em></p>
      <p>Lecture 5 - Version 1.0</p>
    </footer>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      renderMathInElement(document.body, {
        delimiters: [{left: '$$', right: '$$', display: true}, {left: '$', right: '$', display: false}]
      });
      initBondVectors();
      initOrthogonality();
      initProjection();
      initBondAngleCalculator();
    });

    function toggleSolution(id) {
      const sol = document.getElementById(id);
      sol.classList.toggle('show');
      const btn = sol.previousElementSibling.querySelector('.solution-toggle');
      btn.textContent = sol.classList.contains('show') ? 'Hide Solution' : 'Show Solution';
    }

    function drawArrow(ctx, fromX, fromY, toX, toY, color, width) {
      const headLen = 12;
      const angle = Math.atan2(toY - fromY, toX - fromX);
      ctx.strokeStyle = color;
      ctx.lineWidth = width;
      ctx.lineCap = 'round';
      ctx.beginPath();
      ctx.moveTo(fromX, fromY);
      ctx.lineTo(toX, toY);
      ctx.stroke();
      ctx.beginPath();
      ctx.moveTo(toX, toY);
      ctx.lineTo(toX - headLen * Math.cos(angle - Math.PI/6), toY - headLen * Math.sin(angle - Math.PI/6));
      ctx.lineTo(toX - headLen * Math.cos(angle + Math.PI/6), toY - headLen * Math.sin(angle + Math.PI/6));
      ctx.closePath();
      ctx.fillStyle = color;
      ctx.fill();
    }

    function initBondVectors() {
      const canvas = document.getElementById('bondVectorsCanvas');
      const ctx = canvas.getContext('2d');
      ctx.fillStyle = '#0a0a0f';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      const cx = canvas.width / 2, cy = canvas.height / 2, scale = 150;

      ctx.beginPath();
      ctx.arc(cx, cy, 25, 0, Math.PI * 2);
      ctx.fillStyle = '#e07a5f';
      ctx.fill();
      ctx.fillStyle = '#fff';
      ctx.font = 'bold 14px Inter';
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.fillText('O', cx, cy);

      const h1x = cx + 0.958 * scale, h1y = cy;
      const h2x = cx + (-0.240) * scale, h2y = cy - (0.927) * scale;

      ctx.strokeStyle = '#6bcfcf';
      ctx.lineWidth = 3;
      ctx.beginPath(); ctx.moveTo(cx, cy); ctx.lineTo(h1x, h1y); ctx.stroke();
      ctx.beginPath(); ctx.moveTo(cx, cy); ctx.lineTo(h2x, h2y); ctx.stroke();

      ctx.beginPath(); ctx.arc(h1x, h1y, 15, 0, Math.PI * 2);
      ctx.fillStyle = '#81b29a'; ctx.fill();
      ctx.fillStyle = '#fff'; ctx.font = 'bold 12px Inter'; ctx.fillText('H1', h1x, h1y);

      ctx.beginPath(); ctx.arc(h2x, h2y, 15, 0, Math.PI * 2);
      ctx.fillStyle = '#81b29a'; ctx.fill();
      ctx.fillStyle = '#fff'; ctx.fillText('H2', h2x, h2y);

      ctx.beginPath();
      ctx.arc(cx, cy, 50, 0, -Math.atan2(0.927, -0.240), true);
      ctx.strokeStyle = '#d4a574';
      ctx.lineWidth = 2;
      ctx.stroke();

      ctx.fillStyle = '#d4a574';
      ctx.font = 'bold 14px Inter';
      ctx.fillText('104.5 deg', cx - 50, cy - 50);
    }

    function initOrthogonality() {
      const canvas = document.getElementById('orthogonalityCanvas');
      const ctx = canvas.getContext('2d');
      const slider = document.getElementById('rotateW');

      function draw() {
        ctx.fillStyle = '#0a0a0f';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        const cx = canvas.width / 2, cy = canvas.height / 2, scale = 120;

        ctx.strokeStyle = '#2a2a35';
        ctx.lineWidth = 1;
        ctx.beginPath(); ctx.moveTo(0, cy); ctx.lineTo(canvas.width, cy); ctx.stroke();
        ctx.beginPath(); ctx.moveTo(cx, 0); ctx.lineTo(cx, canvas.height); ctx.stroke();

        const angle = parseFloat(slider.value) * Math.PI / 180;
        const wx = Math.cos(angle), wy = Math.sin(angle);
        const dot = wx;
        const theta = Math.acos(Math.max(-1, Math.min(1, dot))) * 180 / Math.PI;

        drawArrow(ctx, cx, cy, cx + scale, cy, '#6bcfcf', 3);
        ctx.fillStyle = '#6bcfcf'; ctx.font = 'bold 16px Inter'; ctx.fillText('v', cx + scale + 10, cy);

        drawArrow(ctx, cx, cy, cx + wx * scale, cy - wy * scale, '#e07a5f', 3);
        ctx.fillStyle = '#e07a5f'; ctx.fillText('w', cx + wx * scale + 10, cy - wy * scale - 10);

        document.getElementById('dotProductValue').textContent = dot.toFixed(2);
        document.getElementById('angleValue').textContent = theta.toFixed(1) + ' deg';
        let rel = Math.abs(dot) < 0.01 ? 'Perpendicular' : (dot > 0 ? 'Acute' : 'Obtuse');
        document.getElementById('relationshipValue').textContent = rel;
        document.getElementById('dotProductValue').style.color = dot > 0.01 ? '#81b29a' : (dot < -0.01 ? '#e07a5f' : '#d4a574');
      }

      slider.addEventListener('input', draw);
      draw();
    }

    function initProjection() {
      const canvas = document.getElementById('projectionCanvas');
      const ctx = canvas.getContext('2d');
      const angleSlider = document.getElementById('vAngle');
      const magSlider = document.getElementById('vMagnitude');

      function draw() {
        ctx.fillStyle = '#0a0a0f';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        const cx = 100, cy = canvas.height - 80;

        const vAngle = parseFloat(angleSlider.value) * Math.PI / 180;
        const vMag = parseFloat(magSlider.value);
        const vx = Math.cos(vAngle), vy = Math.sin(vAngle);
        const proj = vx * vMag;
        const perpY = vy * vMag;

        ctx.strokeStyle = '#3a3a5a';
        ctx.setLineDash([5, 5]);
        ctx.beginPath(); ctx.moveTo(cx - 50, cy); ctx.lineTo(cx + 450, cy); ctx.stroke();
        ctx.setLineDash([]);

        ctx.strokeStyle = '#6b6965';
        ctx.setLineDash([3, 3]);
        ctx.beginPath(); ctx.moveTo(cx + vx * vMag, cy - vy * vMag); ctx.lineTo(cx + proj, cy); ctx.stroke();
        ctx.setLineDash([]);

        drawArrow(ctx, cx, cy, cx + 400, cy, '#e07a5f', 3);
        ctx.fillStyle = '#e07a5f'; ctx.font = 'bold 16px Inter'; ctx.fillText('w', cx + 415, cy + 5);

        if (Math.abs(proj) > 5) {
          drawArrow(ctx, cx, cy, cx + proj, cy, '#9d8cff', 4);
          ctx.fillStyle = '#9d8cff'; ctx.fillText('proj', cx + proj/2 - 15, cy + 25);
        }

        drawArrow(ctx, cx, cy, cx + vx * vMag, cy - vy * vMag, '#6bcfcf', 3);
        ctx.fillStyle = '#6bcfcf'; ctx.fillText('v', cx + vx * vMag + 10, cy - vy * vMag - 10);

        document.getElementById('projVectorV').textContent = '(' + (vx * vMag).toFixed(0) + ', ' + (vy * vMag).toFixed(0) + ')';
        document.getElementById('projVectorProj').textContent = '(' + proj.toFixed(0) + ', 0)';
        document.getElementById('projVectorPerp').textContent = '(0, ' + perpY.toFixed(0) + ')';
      }

      angleSlider.addEventListener('input', draw);
      magSlider.addEventListener('input', draw);
      draw();
    }

    function initBondAngleCalculator() {
      const canvas = document.getElementById('bondAngleCanvas');
      const ctx = canvas.getContext('2d');
      const select = document.getElementById('moleculeSelect');

      const molecules = {
        water: { center: {s:'O', c:'#e07a5f'}, atoms: [{s:'H', p:[0.958,0,0], c:'#81b29a'}, {s:'H', p:[-0.240,0.927,0], c:'#81b29a'}] },
        methane: { center: {s:'C', c:'#6b6965'}, atoms: [{s:'H', p:[1,1,1], c:'#81b29a'}, {s:'H', p:[1,-1,-1], c:'#81b29a'}] },
        ammonia: { center: {s:'N', c:'#6bcfcf'}, atoms: [{s:'H', p:[0.940,0,-0.380], c:'#81b29a'}, {s:'H', p:[-0.470,0.814,-0.380], c:'#81b29a'}] },
        co2: { center: {s:'C', c:'#6b6965'}, atoms: [{s:'O', p:[1.16,0,0], c:'#e07a5f'}, {s:'O', p:[-1.16,0,0], c:'#e07a5f'}] },
        bf3: { center: {s:'B', c:'#d4a574'}, atoms: [{s:'F', p:[1.3,0,0], c:'#9d8cff'}, {s:'F', p:[-0.65,1.126,0], c:'#9d8cff'}] }
      };

      function mag(v) { return Math.sqrt(v[0]*v[0] + v[1]*v[1] + v[2]*v[2]); }
      function norm(v) { const m = mag(v); return [v[0]/m, v[1]/m, v[2]/m]; }
      function dot(a,b) { return a[0]*b[0] + a[1]*b[1] + a[2]*b[2]; }

      function draw() {
        ctx.fillStyle = '#0a0a0f';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        const mol = molecules[select.value];
        const cx = canvas.width / 2, cy = canvas.height / 2, scale = 100;

        const b1 = mol.atoms[0].p, b2 = mol.atoms[1].p;
        const b1n = norm(b1), b2n = norm(b2);
        const dotProd = dot(b1, b2);
        const cosT = dotProd / (mag(b1) * mag(b2));
        const theta = Math.acos(Math.max(-1, Math.min(1, cosT))) * 180 / Math.PI;

        const h1x = cx + b1n[0] * scale * 1.5, h1y = cy - b1n[1] * scale * 1.5;
        const h2x = cx + b2n[0] * scale * 1.5, h2y = cy - b2n[1] * scale * 1.5;

        ctx.strokeStyle = '#6bcfcf';
        ctx.lineWidth = 4;
        ctx.beginPath(); ctx.moveTo(cx, cy); ctx.lineTo(h1x, h1y); ctx.stroke();
        ctx.beginPath(); ctx.moveTo(cx, cy); ctx.lineTo(h2x, h2y); ctx.stroke();

        ctx.beginPath();
        ctx.arc(cx, cy, 40, Math.atan2(-b1n[1], b1n[0]), Math.atan2(-b2n[1], b2n[0]), Math.atan2(-b1n[1], b1n[0]) > Math.atan2(-b2n[1], b2n[0]));
        ctx.strokeStyle = '#d4a574'; ctx.lineWidth = 2; ctx.stroke();

        ctx.beginPath(); ctx.arc(cx, cy, 25, 0, Math.PI * 2);
        ctx.fillStyle = mol.center.c; ctx.fill();
        ctx.fillStyle = '#fff'; ctx.font = 'bold 16px Inter'; ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
        ctx.fillText(mol.center.s, cx, cy);

        ctx.beginPath(); ctx.arc(h1x, h1y, 18, 0, Math.PI * 2);
        ctx.fillStyle = mol.atoms[0].c; ctx.fill();
        ctx.fillStyle = '#fff'; ctx.font = 'bold 12px Inter'; ctx.fillText(mol.atoms[0].s, h1x, h1y);

        ctx.beginPath(); ctx.arc(h2x, h2y, 18, 0, Math.PI * 2);
        ctx.fillStyle = mol.atoms[1].c; ctx.fill();
        ctx.fillText(mol.atoms[1].s, h2x, h2y);

        document.getElementById('bond1Vector').textContent = 'b1 = (' + b1[0].toFixed(2) + ', ' + b1[1].toFixed(2) + ', ' + b1[2].toFixed(2) + ')';
        document.getElementById('bond2Vector').textContent = 'b2 = (' + b2[0].toFixed(2) + ', ' + b2[1].toFixed(2) + ', ' + b2[2].toFixed(2) + ')';
        document.getElementById('bondDotProduct').textContent = dotProd.toFixed(3);
        document.getElementById('calculatedBondAngle').textContent = theta.toFixed(1) + ' deg';
      }

      select.addEventListener('change', draw);
      draw();
    }
  </script>
</body>
</html>
