<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lecture 18: Integration Techniques | Chemical Thinking</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Fraunces:opsz,wght@9..144,400;9..144,700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-tertiary: #1a1a24;
            --bg-card: #16161f;
            --text-primary: #e8e6e3;
            --text-secondary: #a0a0a0;
            --text-muted: #6b6b6b;
            --accent-red: #ef4444;
            --accent-orange: #f59e0b;
            --accent-blue: #4a9eff;
            --accent-purple: #8b5cf6;
            --accent-green: #10b981;
            --accent-cyan: #06b6d4;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.7;
            font-size: 17px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Navigation */
        .lecture-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--bg-tertiary);
        }

        .nav-link {
            color: var(--text-secondary);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: color 0.2s;
        }

        .nav-link:hover { color: var(--accent-purple); }

        .primitive-link {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.1), rgba(139, 92, 246, 0.1));
            border: 1px solid rgba(168, 85, 247, 0.3);
            text-decoration: none;
            transition: all 0.3s;
        }

        .primitive-link:hover {
            border-color: var(--accent-purple);
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.2);
        }

        .primitive-badge {
            background: #a855f7;
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
            font-family: 'JetBrains Mono', monospace;
        }

        .primitive-text {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        /* Header */
        header {
            text-align: center;
            margin-bottom: 4rem;
            padding: 3rem 0;
        }

        .lecture-number {
            font-family: 'JetBrains Mono', monospace;
            color: #a855f7;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            letter-spacing: 0.1em;
        }

        h1 {
            font-family: 'Fraunces', serif;
            font-size: 2.8rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #a855f7, var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            font-style: italic;
        }

        /* Sections */
        section {
            margin-bottom: 4rem;
        }

        h2 {
            font-family: 'Fraunces', serif;
            font-size: 1.8rem;
            color: #a855f7;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--bg-tertiary);
        }

        h3 {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin: 2rem 0 1rem;
        }

        h4 {
            font-size: 1.1rem;
            color: var(--accent-blue);
            margin: 1.5rem 0 0.75rem;
        }

        p {
            margin-bottom: 1.5rem;
            color: var(--text-secondary);
        }

        strong { color: var(--text-primary); }

        /* Hook Box */
        .hook-box {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.1), rgba(74, 158, 255, 0.05));
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 3rem;
        }

        .hook-box p:last-child { margin-bottom: 0; }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            background: var(--bg-secondary);
            border-radius: 8px;
            overflow: hidden;
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--bg-tertiary);
        }

        th {
            background: var(--bg-tertiary);
            font-weight: 600;
            color: var(--text-primary);
        }

        td { color: var(--text-secondary); }

        tr:last-child td { border-bottom: none; }

        /* Definition boxes */
        .definition-box {
            background: var(--bg-secondary);
            border-left: 4px solid #a855f7;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 8px 8px 0;
        }

        .definition-box .term {
            font-weight: 600;
            color: #a855f7;
        }

        /* Formula box */
        .formula-box {
            background: var(--bg-secondary);
            border: 1px solid var(--accent-blue);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            text-align: center;
        }

        .formula-box h4 {
            color: var(--accent-blue);
            margin-bottom: 1rem;
            margin-top: 0;
        }

        /* Key insight */
        .key-insight {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.1), rgba(74, 158, 255, 0.1));
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 2rem 0;
            text-align: center;
        }

        .key-insight p {
            color: var(--text-primary);
            font-size: 1.1rem;
            margin: 0;
        }

        /* Example box */
        .example-box {
            background: var(--bg-card);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 3px solid var(--accent-orange);
        }

        .example-box h4 {
            color: var(--accent-orange);
            margin-bottom: 1rem;
            margin-top: 0;
        }

        /* Interactive visualizations */
        .visualization {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 2rem 0;
        }

        .viz-title {
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .canvas-container {
            background: var(--bg-primary);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        canvas {
            display: block;
            width: 100%;
            border-radius: 4px;
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .control-group {
            flex: 1;
            min-width: 200px;
        }

        .control-group label {
            display: block;
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        input[type="range"] {
            width: 100%;
            accent-color: #a855f7;
        }

        select {
            width: 100%;
            padding: 0.5rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--bg-card);
            color: var(--text-primary);
            border-radius: 4px;
        }

        .value-display {
            font-family: 'JetBrains Mono', monospace;
            color: #a855f7;
            font-size: 0.9rem;
        }

        /* Info box */
        .info-box {
            background: var(--bg-card);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .info-row:last-child { margin-bottom: 0; }

        .info-label { color: var(--text-muted); }
        .info-value { color: var(--accent-green); }

        /* Tabular method */
        .tabular-table {
            font-family: 'JetBrains Mono', monospace;
        }

        .tabular-table td.sign-plus { color: var(--accent-green); }
        .tabular-table td.sign-minus { color: var(--accent-red); }

        /* Lists */
        ul, ol {
            margin: 1rem 0 1.5rem 1.5rem;
            color: var(--text-secondary);
        }

        li { margin-bottom: 0.5rem; }

        /* Code */
        code {
            font-family: 'JetBrains Mono', monospace;
            background: var(--bg-tertiary);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-size: 0.9em;
        }

        /* LIATE box */
        .liate-box {
            background: var(--bg-secondary);
            border: 2px solid var(--accent-orange);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .liate-box h4 {
            color: var(--accent-orange);
            margin-bottom: 1rem;
        }

        .liate-list {
            list-style: none;
            margin-left: 0;
        }

        .liate-list li {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.5rem 0;
        }

        .liate-letter {
            font-family: 'Fraunces', serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent-orange);
            width: 2rem;
        }

        /* Footer */
        footer {
            margin-top: 4rem;
            padding-top: 2rem;
            border-top: 1px solid var(--bg-tertiary);
            text-align: center;
            color: var(--text-muted);
        }

        footer a {
            color: #a855f7;
            text-decoration: none;
        }

        footer a:hover { text-decoration: underline; }

        /* Responsive */
        @media (max-width: 768px) {
            h1 { font-size: 2rem; }
            .container { padding: 1rem; }
            .controls { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="container">
        <nav class="lecture-nav">
            <a href="../all-lectures.html" class="nav-link">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
                All Lectures
            </a>
            <a href="../../primitives/accumulation.html" class="primitive-link">
                <span class="primitive-badge">ACCUMULATION</span>
                <span class="primitive-text">Explore the Primitive</span>
            </a>
        </nav>

        <header>
            <div class="lecture-number">LECTURE 18</div>
            <h1>Integration Techniques</h1>
            <p class="subtitle">The toolkit for harder integrals</p>
        </header>

        <!-- THE HOOK -->
        <section>
            <div class="hook-box">
                <p>The normalization integral for the quantum harmonic oscillator ground state:</p>
                <p style="text-align: center; font-size: 1.2rem;">$$\int_{-\infty}^{\infty} x^2 e^{-\alpha x^2} \, dx = \, ?$$</p>
                <p>This isn't a simple substitution. The $x^2$ and $e^{-\alpha x^2}$ are tangled together.</p>
                <p style="text-align: center; font-size: 1.1rem;"><strong>You need integration by parts.</strong></p>
                <p style="margin-top: 1.5rem;">Or consider consecutive reactions A → B → C requiring partial fractions decomposition.</p>
                <p style="text-align: center; font-size: 1.1rem;"><strong>You need partial fractions.</strong></p>
            </div>
        </section>

        <!-- WHEN TO USE WHICH -->
        <section>
            <h2>When to Use Which Technique</h2>

            <table>
                <tr>
                    <th>Integrand looks like...</th>
                    <th>Technique</th>
                </tr>
                <tr>
                    <td>Product of two different types</td>
                    <td><strong>Integration by parts</strong></td>
                </tr>
                <tr>
                    <td>(polynomial) × (exp, sin, cos, ln)</td>
                    <td>Integration by parts</td>
                </tr>
                <tr>
                    <td>Rational function P(x)/Q(x)</td>
                    <td><strong>Partial fractions</strong></td>
                </tr>
                <tr>
                    <td>√(a² - x²)</td>
                    <td>Trig sub: x = a sin θ</td>
                </tr>
                <tr>
                    <td>√(a² + x²)</td>
                    <td>Trig sub: x = a tan θ</td>
                </tr>
                <tr>
                    <td>√(x² - a²)</td>
                    <td>Trig sub: x = a sec θ</td>
                </tr>
                <tr>
                    <td>Powers of sin and cos</td>
                    <td><strong>Trig identities</strong></td>
                </tr>
            </table>
        </section>

        <!-- INTEGRATION BY PARTS -->
        <section>
            <h2>Integration by Parts</h2>

            <div class="formula-box">
                <h4>The Formula</h4>
                <p>From the product rule: $(uv)' = u'v + uv'$</p>
                <p>Rearrange and integrate:</p>
                <p style="font-size: 1.3rem;">$$\int u \, dv = uv - \int v \, du$$</p>
            </div>

            <div class="liate-box">
                <h4>The LIATE Rule</h4>
                <p>Choose <strong>u</strong> in this priority order (earlier = better choice for u):</p>
                <ul class="liate-list">
                    <li><span class="liate-letter">L</span> Logarithmic (ln x, log x)</li>
                    <li><span class="liate-letter">I</span> Inverse trig (arctan, arcsin)</li>
                    <li><span class="liate-letter">A</span> Algebraic (x, x², polynomials)</li>
                    <li><span class="liate-letter">T</span> Trigonometric (sin, cos, tan)</li>
                    <li><span class="liate-letter">E</span> Exponential (eˣ, aˣ)</li>
                </ul>
            </div>

            <div class="example-box">
                <h4>Example 1: ∫ x eˣ dx</h4>
                <p><strong>Identify:</strong> x (algebraic) × eˣ (exponential)</p>
                <p>By LIATE: A comes before E → <strong>u = x</strong>, dv = eˣ dx</p>
                <table>
                    <tr><td>u = x</td><td>dv = eˣ dx</td></tr>
                    <tr><td>du = dx</td><td>v = eˣ</td></tr>
                </table>
                <p>$$\int x e^x dx = xe^x - \int e^x dx = xe^x - e^x + C = e^x(x-1) + C$$</p>
            </div>

            <div class="visualization">
                <div class="viz-title">Interactive: Integration by Parts for ∫ xⁿ eˣ dx</div>
                <div class="canvas-container">
                    <canvas id="byPartsCanvas" width="800" height="400"></canvas>
                </div>
                <div class="controls">
                    <div class="control-group">
                        <label>Power of x: <span class="value-display" id="powerValue">2</span></label>
                        <input type="range" id="powerSlider" min="1" max="4" value="2">
                    </div>
                </div>
                <div class="info-box" id="byPartsResult">
                    Antiderivative will appear here
                </div>
            </div>

            <h3>The Tabular Method</h3>
            <p>For integrals like $\int x^n e^x dx$, use a table to organize repeated by parts:</p>

            <div class="example-box">
                <h4>Example: ∫ x³ eˣ dx using Tabular Method</h4>
                <table class="tabular-table">
                    <tr>
                        <th>Derivatives (u)</th>
                        <th>Integrals (dv)</th>
                        <th>Sign</th>
                    </tr>
                    <tr>
                        <td>x³</td>
                        <td>eˣ</td>
                        <td class="sign-plus">+</td>
                    </tr>
                    <tr>
                        <td>3x²</td>
                        <td>eˣ</td>
                        <td class="sign-minus">−</td>
                    </tr>
                    <tr>
                        <td>6x</td>
                        <td>eˣ</td>
                        <td class="sign-plus">+</td>
                    </tr>
                    <tr>
                        <td>6</td>
                        <td>eˣ</td>
                        <td class="sign-minus">−</td>
                    </tr>
                    <tr>
                        <td>0</td>
                        <td>eˣ</td>
                        <td class="sign-plus">+</td>
                    </tr>
                </table>
                <p><strong>Result:</strong> $e^x(x^3 - 3x^2 + 6x - 6) + C$</p>
                <p style="color: var(--text-muted);">Multiply diagonally, alternating signs!</p>
            </div>

            <div class="example-box">
                <h4>Example: ∫ ln x dx</h4>
                <p>Clever trick: write as ln x · 1</p>
                <p>u = ln x, dv = dx → du = (1/x)dx, v = x</p>
                <p>$$\int \ln x \, dx = x\ln x - \int x \cdot \frac{1}{x} dx = x\ln x - x + C = x(\ln x - 1) + C$$</p>
            </div>
        </section>

        <!-- PARTIAL FRACTIONS -->
        <section>
            <h2>Partial Fractions</h2>

            <p>For rational functions $\frac{P(x)}{Q(x)}$ where degree(P) < degree(Q).</p>

            <div class="key-insight">
                <p><strong>Factor the denominator, then decompose into simpler fractions.</strong><br>
                Each simple fraction is easy to integrate.</p>
            </div>

            <h3>Case 1: Distinct Linear Factors</h3>

            <div class="formula-box">
                <p>$$\frac{1}{(x-a)(x-b)} = \frac{A}{x-a} + \frac{B}{x-b}$$</p>
            </div>

            <div class="visualization">
                <div class="viz-title">Interactive: Partial Fraction Decomposition</div>
                <div class="canvas-container">
                    <canvas id="partialCanvas" width="800" height="350"></canvas>
                </div>
                <div class="controls">
                    <div class="control-group">
                        <label>Root a: <span class="value-display" id="rootAValue">-1</span></label>
                        <input type="range" id="rootASlider" min="-3" max="0" value="-1">
                    </div>
                    <div class="control-group">
                        <label>Root b: <span class="value-display" id="rootBValue">2</span></label>
                        <input type="range" id="rootBSlider" min="1" max="4" value="2">
                    </div>
                </div>
                <div class="info-box" id="partialResult">
                    Decomposition will appear here
                </div>
            </div>

            <h3>Case 2: Repeated Linear Factors</h3>

            <div class="formula-box">
                <p>$(x-a)^n$ in denominator requires:</p>
                <p>$$\frac{A_1}{x-a} + \frac{A_2}{(x-a)^2} + \cdots + \frac{A_n}{(x-a)^n}$$</p>
            </div>

            <h3>Case 3: Irreducible Quadratic Factors</h3>

            <div class="formula-box">
                <p>$(x^2 + bx + c)$ in denominator:</p>
                <p>$$\frac{Ax + B}{x^2 + bx + c}$$</p>
            </div>

            <div class="example-box">
                <h4>Example: ∫ (2x+3)/(x²+1) dx</h4>
                <p>Split into two parts:</p>
                <p>$$= \int \frac{2x}{x^2+1} dx + \int \frac{3}{x^2+1} dx$$</p>
                <p>$$= \ln(x^2+1) + 3\arctan(x) + C$$</p>
            </div>
        </section>

        <!-- TRIG SUBSTITUTION -->
        <section>
            <h2>Trigonometric Substitution</h2>

            <p>For integrands containing square roots of quadratics:</p>

            <table>
                <tr>
                    <th>Expression</th>
                    <th>Substitution</th>
                    <th>Identity used</th>
                </tr>
                <tr>
                    <td>√(a² - x²)</td>
                    <td>x = a sin θ</td>
                    <td>1 - sin²θ = cos²θ</td>
                </tr>
                <tr>
                    <td>√(a² + x²)</td>
                    <td>x = a tan θ</td>
                    <td>1 + tan²θ = sec²θ</td>
                </tr>
                <tr>
                    <td>√(x² - a²)</td>
                    <td>x = a sec θ</td>
                    <td>sec²θ - 1 = tan²θ</td>
                </tr>
            </table>

            <div class="visualization">
                <div class="viz-title">Interactive: Trig Substitution Geometry</div>
                <div class="canvas-container">
                    <canvas id="trigSubCanvas" width="800" height="350"></canvas>
                </div>
                <div class="controls">
                    <div class="control-group">
                        <label>Substitution type:</label>
                        <select id="trigSubType">
                            <option value="sin">√(a² - x²): x = a sin θ</option>
                            <option value="tan">√(a² + x²): x = a tan θ</option>
                            <option value="sec">√(x² - a²): x = a sec θ</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label>Angle θ: <span class="value-display" id="thetaValue">45</span>°</label>
                        <input type="range" id="thetaSlider" min="5" max="85" value="45">
                    </div>
                </div>
                <div class="info-box" id="trigSubInfo">
                    Triangle relationships will appear here
                </div>
            </div>

            <div class="example-box">
                <h4>Example: ∫ 1/(x² + a²) dx</h4>
                <p>Let x = a tan θ, dx = a sec²θ dθ</p>
                <p>x² + a² = a²tan²θ + a² = a²sec²θ</p>
                <p>$$\int \frac{1}{x^2 + a^2} dx = \int \frac{a\sec^2\theta}{a^2\sec^2\theta} d\theta = \frac{1}{a}\int d\theta = \frac{1}{a}\arctan\left(\frac{x}{a}\right) + C$$</p>
            </div>
        </section>

        <!-- CHEMISTRY: SECOND ORDER KINETICS -->
        <section>
            <h2>Chemistry Application: Second-Order Kinetics</h2>

            <p>For 2A → products with $-\frac{d[A]}{dt} = k[A]^2$:</p>

            <div class="visualization">
                <div class="viz-title">Interactive: Second-Order Kinetics</div>
                <div class="canvas-container">
                    <canvas id="kineticsCanvas" width="800" height="400"></canvas>
                </div>
                <div class="controls">
                    <div class="control-group">
                        <label>Rate constant k (M⁻¹s⁻¹): <span class="value-display" id="kValue">0.05</span></label>
                        <input type="range" id="kSlider" min="0.01" max="0.1" step="0.01" value="0.05">
                    </div>
                    <div class="control-group">
                        <label>Initial [A]₀ (M): <span class="value-display" id="a0Value">1.0</span></label>
                        <input type="range" id="a0Slider" min="0.5" max="2" step="0.1" value="1.0">
                    </div>
                </div>
                <div class="info-box">
                    <div class="info-row">
                        <span class="info-label">Integrated rate law:</span>
                        <span class="info-value">1/[A] = 1/[A]₀ + kt</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Half-life:</span>
                        <span class="info-value" id="halfLifeValue">t₁/₂ = 20.0 s</span>
                    </div>
                </div>
            </div>

            <div class="formula-box">
                <h4>Derivation</h4>
                <p>$$\int \frac{d[A]}{[A]^2} = -k\int dt$$</p>
                <p>$$-\frac{1}{[A]} = -kt + C$$</p>
                <p>At t = 0: $C = -\frac{1}{[A]_0}$</p>
                <p style="font-size: 1.2rem;">$$\frac{1}{[A]} = \frac{1}{[A]_0} + kt$$</p>
                <p>Half-life: $t_{1/2} = \frac{1}{k[A]_0}$ — depends on initial concentration!</p>
            </div>
        </section>

        <!-- CHEMISTRY: GAUSSIAN INTEGRALS -->
        <section>
            <h2>Chemistry Application: Gaussian Integrals</h2>

            <p>The integral $\int x^2 e^{-\alpha x^2} dx$ appears in quantum mechanics for expectation values.</p>

            <div class="visualization">
                <div class="viz-title">Interactive: Gaussian x² Integral</div>
                <div class="canvas-container">
                    <canvas id="gaussCanvas" width="800" height="350"></canvas>
                </div>
                <div class="controls">
                    <div class="control-group">
                        <label>Parameter α: <span class="value-display" id="alphaValue">1.0</span></label>
                        <input type="range" id="alphaSlider" min="0.5" max="5" step="0.5" value="1">
                    </div>
                </div>
                <div class="info-box">
                    <div class="info-row">
                        <span class="info-label">∫₀^∞ x² e^(-αx²) dx =</span>
                        <span class="info-value" id="gaussResult">√π/(4α^(3/2)) = 0.4431</span>
                    </div>
                </div>
            </div>

            <div class="formula-box">
                <h4>Derivation by Parts</h4>
                <p>Let u = x, dv = xe^(-αx²)dx → v = -1/(2α)e^(-αx²)</p>
                <p>$$\int_0^{\infty} x^2 e^{-\alpha x^2} dx = \left[-\frac{x}{2\alpha}e^{-\alpha x^2}\right]_0^{\infty} + \frac{1}{2\alpha}\int_0^{\infty} e^{-\alpha x^2} dx$$</p>
                <p>Boundary terms vanish. Using $\int_0^{\infty} e^{-\alpha x^2} dx = \frac{1}{2}\sqrt{\frac{\pi}{\alpha}}$:</p>
                <p style="font-size: 1.2rem;">$$= \frac{1}{2\alpha} \cdot \frac{1}{2}\sqrt{\frac{\pi}{\alpha}} = \frac{\sqrt{\pi}}{4\alpha^{3/2}}$$</p>
            </div>
        </section>

        <!-- SUMMARY -->
        <section>
            <h2>Summary: Strategy</h2>

            <ol>
                <li><strong>Simplify first</strong> (algebra, trig identities)</li>
                <li><strong>Substitution</strong> works? Try it.</li>
                <li><strong>By parts</strong> for products of different types</li>
                <li><strong>Partial fractions</strong> for rational functions</li>
                <li><strong>Trig substitution</strong> for square roots of quadratics</li>
                <li><strong>Trig identities</strong> for powers of sin/cos</li>
                <li><strong>Tables</strong> for standard forms</li>
                <li><strong>Numerical</strong> if all else fails</li>
            </ol>

            <h3>Quick Reference</h3>
            <table>
                <tr>
                    <th>Integral</th>
                    <th>Result</th>
                </tr>
                <tr>
                    <td>∫ xeˣ dx</td>
                    <td>eˣ(x-1) + C</td>
                </tr>
                <tr>
                    <td>∫ x sin x dx</td>
                    <td>-x cos x + sin x + C</td>
                </tr>
                <tr>
                    <td>∫ ln x dx</td>
                    <td>x(ln x - 1) + C</td>
                </tr>
                <tr>
                    <td>∫ 1/(x²+a²) dx</td>
                    <td>(1/a) arctan(x/a) + C</td>
                </tr>
                <tr>
                    <td>∫ 1/((x-a)(x-b)) dx</td>
                    <td>(1/(a-b)) ln|(x-a)/(x-b)| + C</td>
                </tr>
            </table>
        </section>

        <footer>
            <p>Chemical Thinking: The Grammar of Reality</p>
            <p><a href="../17-integrals/">← Lecture 17: Integrals</a> · <a href="../19-diff-eq/">Lecture 19: Differential Equations →</a></p>
        </footer>
    </div>

    <script>
        // Initialize KaTeX
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: "$$", right: "$$", display: true},
                    {left: "$", right: "$", display: false}
                ]
            });

            initByPartsViz();
            initPartialViz();
            initTrigSubViz();
            initKineticsViz();
            initGaussViz();
        });

        // ===== BY PARTS VISUALIZATION =====
        function initByPartsViz() {
            const canvas = document.getElementById('byPartsCanvas');
            const ctx = canvas.getContext('2d');
            const slider = document.getElementById('powerSlider');
            const resultBox = document.getElementById('byPartsResult');

            function factorial(n) {
                if (n <= 1) return 1;
                return n * factorial(n - 1);
            }

            function draw() {
                const n = parseInt(slider.value);
                document.getElementById('powerValue').textContent = n;

                const width = canvas.width;
                const height = canvas.height;
                const padding = 50;

                ctx.clearRect(0, 0, width, height);

                // Function: x^n * e^x
                const f = x => Math.pow(x, n) * Math.exp(x);

                // Antiderivative: e^x * sum of terms
                // F(x) = e^x * (x^n - n*x^(n-1) + n*(n-1)*x^(n-2) - ...)
                const F = x => {
                    let sum = 0;
                    for (let k = 0; k <= n; k++) {
                        const coef = factorial(n) / factorial(n - k);
                        const sign = (k % 2 === 0) ? 1 : -1;
                        sum += sign * coef * Math.pow(x, n - k);
                    }
                    return Math.exp(x) * sum;
                };

                // Generate result text
                let terms = [];
                for (let k = 0; k <= n; k++) {
                    const coef = factorial(n) / factorial(n - k);
                    const sign = (k % 2 === 0) ? '+' : '-';
                    if (n - k === 0) {
                        terms.push(`${sign === '+' ? '' : '-'}${coef}`);
                    } else if (n - k === 1) {
                        terms.push(`${sign}${coef}x`);
                    } else {
                        terms.push(`${sign}${coef === 1 ? '' : coef}x${supScript(n-k)}`);
                    }
                }
                resultBox.innerHTML = `<strong>∫ x<sup>${n}</sup>e<sup>x</sup> dx = e<sup>x</sup>(${terms.join(' ')}) + C</strong>`;

                // Plot range
                const xMin = -1, xMax = 2.5;
                const xScale = (width - 2*padding) / (xMax - xMin);

                // Find appropriate y scale
                let yMax = 0;
                for (let x = xMin; x <= xMax; x += 0.1) {
                    if (x <= 2) yMax = Math.max(yMax, Math.abs(f(x)));
                }
                yMax = Math.min(yMax, 30);
                const yScale = (height - 2*padding) / (2 * yMax);

                const toCanvasX = x => padding + (x - xMin) * xScale;
                const toCanvasY = y => height/2 - y * yScale;

                // Axes
                ctx.strokeStyle = '#6b6b6b';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(padding, height/2);
                ctx.lineTo(width - padding, height/2);
                ctx.moveTo(toCanvasX(0), padding);
                ctx.lineTo(toCanvasX(0), height - padding);
                ctx.stroke();

                // Plot f(x)
                ctx.strokeStyle = '#4a9eff';
                ctx.lineWidth = 3;
                ctx.beginPath();
                let started = false;
                for (let x = xMin; x <= xMax; x += 0.02) {
                    const y = f(x);
                    if (Math.abs(y) < yMax * 1.5) {
                        const cx = toCanvasX(x);
                        const cy = toCanvasY(y);
                        if (!started) { ctx.moveTo(cx, cy); started = true; }
                        else ctx.lineTo(cx, cy);
                    }
                }
                ctx.stroke();

                // Plot F(x)
                ctx.strokeStyle = '#10b981';
                ctx.lineWidth = 3;
                ctx.beginPath();
                started = false;
                for (let x = xMin; x <= xMax; x += 0.02) {
                    const y = F(x);
                    if (Math.abs(y) < yMax * 1.5) {
                        const cx = toCanvasX(x);
                        const cy = toCanvasY(y);
                        if (!started) { ctx.moveTo(cx, cy); started = true; }
                        else ctx.lineTo(cx, cy);
                    }
                }
                ctx.stroke();

                // Labels
                ctx.fillStyle = '#4a9eff';
                ctx.font = '14px Inter';
                ctx.fillText(`f(x) = x^${n} e^x`, width - padding - 100, padding + 20);
                ctx.fillStyle = '#10b981';
                ctx.fillText('F(x) = antiderivative', width - padding - 130, padding + 40);
            }

            function supScript(n) {
                const sups = {'0': '⁰', '1': '¹', '2': '²', '3': '³', '4': '⁴'};
                return String(n).split('').map(c => sups[c] || c).join('');
            }

            slider.addEventListener('input', draw);
            draw();
        }

        // ===== PARTIAL FRACTIONS VISUALIZATION =====
        function initPartialViz() {
            const canvas = document.getElementById('partialCanvas');
            const ctx = canvas.getContext('2d');
            const aSlider = document.getElementById('rootASlider');
            const bSlider = document.getElementById('rootBSlider');
            const resultBox = document.getElementById('partialResult');

            function draw() {
                const a = parseInt(aSlider.value);
                const b = parseInt(bSlider.value);
                document.getElementById('rootAValue').textContent = a;
                document.getElementById('rootBValue').textContent = b;

                const A = 1 / (a - b);
                const B = 1 / (b - a);

                resultBox.innerHTML = `
                    <div class="info-row">
                        <span class="info-label">Decomposition:</span>
                        <span class="info-value">1/((x${a>=0?'+':''}${-a})(x${b>=0?'+':''}${-b})) = ${A.toFixed(3)}/(x${a>=0?'+':''}${-a}) + ${B.toFixed(3)}/(x${b>=0?'+':''}${-b})</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Integral:</span>
                        <span class="info-value">${A.toFixed(3)}·ln|x${a>=0?'+':''}${-a}| + ${B.toFixed(3)}·ln|x${b>=0?'+':''}${-b}| + C</span>
                    </div>
                `;

                const width = canvas.width;
                const height = canvas.height;
                const padding = 50;

                ctx.clearRect(0, 0, width, height);

                const xMin = a - 1, xMax = b + 1;
                const xScale = (width - 2*padding) / (xMax - xMin);
                const yMax = 3;
                const yScale = (height - 2*padding) / (2 * yMax);

                const toCanvasX = x => padding + (x - xMin) * xScale;
                const toCanvasY = y => height/2 - y * yScale;

                // Axes
                ctx.strokeStyle = '#6b6b6b';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(padding, height/2);
                ctx.lineTo(width - padding, height/2);
                ctx.stroke();

                // Plot original function (avoiding asymptotes)
                const f = x => 1 / ((x - a) * (x - b));

                ctx.strokeStyle = '#4a9eff';
                ctx.lineWidth = 3;

                // Left of a
                ctx.beginPath();
                let started = false;
                for (let x = xMin; x < a - 0.1; x += 0.02) {
                    const y = f(x);
                    if (Math.abs(y) < yMax) {
                        if (!started) { ctx.moveTo(toCanvasX(x), toCanvasY(y)); started = true; }
                        else ctx.lineTo(toCanvasX(x), toCanvasY(y));
                    }
                }
                ctx.stroke();

                // Between a and b
                ctx.beginPath();
                started = false;
                for (let x = a + 0.1; x < b - 0.1; x += 0.02) {
                    const y = f(x);
                    if (Math.abs(y) < yMax) {
                        if (!started) { ctx.moveTo(toCanvasX(x), toCanvasY(y)); started = true; }
                        else ctx.lineTo(toCanvasX(x), toCanvasY(y));
                    }
                }
                ctx.stroke();

                // Right of b
                ctx.beginPath();
                started = false;
                for (let x = b + 0.1; x <= xMax; x += 0.02) {
                    const y = f(x);
                    if (Math.abs(y) < yMax) {
                        if (!started) { ctx.moveTo(toCanvasX(x), toCanvasY(y)); started = true; }
                        else ctx.lineTo(toCanvasX(x), toCanvasY(y));
                    }
                }
                ctx.stroke();

                // Asymptotes
                ctx.strokeStyle = '#ef4444';
                ctx.lineWidth = 1;
                ctx.setLineDash([5, 5]);
                ctx.beginPath();
                ctx.moveTo(toCanvasX(a), padding);
                ctx.lineTo(toCanvasX(a), height - padding);
                ctx.moveTo(toCanvasX(b), padding);
                ctx.lineTo(toCanvasX(b), height - padding);
                ctx.stroke();
                ctx.setLineDash([]);

                // Labels
                ctx.fillStyle = '#ef4444';
                ctx.font = '12px Inter';
                ctx.textAlign = 'center';
                ctx.fillText(`x = ${a}`, toCanvasX(a), height - padding + 15);
                ctx.fillText(`x = ${b}`, toCanvasX(b), height - padding + 15);
            }

            aSlider.addEventListener('input', draw);
            bSlider.addEventListener('input', draw);
            draw();
        }

        // ===== TRIG SUBSTITUTION VISUALIZATION =====
        function initTrigSubViz() {
            const canvas = document.getElementById('trigSubCanvas');
            const ctx = canvas.getContext('2d');
            const typeSelect = document.getElementById('trigSubType');
            const thetaSlider = document.getElementById('thetaSlider');
            const infoBox = document.getElementById('trigSubInfo');

            function draw() {
                const type = typeSelect.value;
                const thetaDeg = parseInt(thetaSlider.value);
                const theta = thetaDeg * Math.PI / 180;
                document.getElementById('thetaValue').textContent = thetaDeg;

                const width = canvas.width;
                const height = canvas.height;
                const cx = width / 2;
                const cy = height / 2 + 30;
                const scale = 100;

                ctx.clearRect(0, 0, width, height);

                let opp, adj, hyp, label1, label2, label3;
                const a = 1; // reference value

                if (type === 'sin') {
                    // x = a sin θ, √(a² - x²) = a cos θ
                    opp = a * Math.sin(theta);
                    adj = a * Math.cos(theta);
                    hyp = a;
                    label1 = `x = a sin θ = ${opp.toFixed(2)}`;
                    label2 = `√(a²-x²) = a cos θ = ${adj.toFixed(2)}`;
                    label3 = `hypotenuse = a = ${hyp.toFixed(2)}`;
                } else if (type === 'tan') {
                    // x = a tan θ, √(a² + x²) = a sec θ
                    opp = a * Math.tan(theta);
                    adj = a;
                    hyp = a / Math.cos(theta);
                    label1 = `x = a tan θ = ${opp.toFixed(2)}`;
                    label2 = `adjacent = a = ${adj.toFixed(2)}`;
                    label3 = `√(a²+x²) = a sec θ = ${hyp.toFixed(2)}`;
                } else {
                    // x = a sec θ, √(x² - a²) = a tan θ
                    hyp = a / Math.cos(theta);
                    adj = a;
                    opp = a * Math.tan(theta);
                    label1 = `x = a sec θ = ${hyp.toFixed(2)}`;
                    label2 = `adjacent = a = ${adj.toFixed(2)}`;
                    label3 = `√(x²-a²) = a tan θ = ${opp.toFixed(2)}`;
                }

                // Draw triangle
                const x0 = cx - 150;
                const y0 = cy + 50;
                const x1 = x0 + adj * scale * 2;
                const y1 = y0;
                const x2 = x1;
                const y2 = y0 - opp * scale * 2;

                // Fill triangle
                ctx.fillStyle = 'rgba(168, 85, 247, 0.2)';
                ctx.beginPath();
                ctx.moveTo(x0, y0);
                ctx.lineTo(x1, y1);
                ctx.lineTo(x2, y2);
                ctx.closePath();
                ctx.fill();

                // Draw sides
                ctx.strokeStyle = '#a855f7';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.moveTo(x0, y0);
                ctx.lineTo(x1, y1);
                ctx.lineTo(x2, y2);
                ctx.closePath();
                ctx.stroke();

                // Right angle marker
                ctx.strokeStyle = '#6b6b6b';
                ctx.lineWidth = 2;
                const sz = 15;
                ctx.beginPath();
                ctx.moveTo(x1 - sz, y1);
                ctx.lineTo(x1 - sz, y1 - sz);
                ctx.lineTo(x1, y1 - sz);
                ctx.stroke();

                // Angle arc
                ctx.strokeStyle = '#f59e0b';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.arc(x0, y0, 30, -theta, 0);
                ctx.stroke();

                // θ label
                ctx.fillStyle = '#f59e0b';
                ctx.font = '16px Inter';
                ctx.fillText('θ', x0 + 40, y0 - 10);

                // Side labels
                ctx.fillStyle = '#e8e6e3';
                ctx.font = '14px Inter';
                ctx.textAlign = 'center';

                // Adjacent (horizontal)
                ctx.fillText(type === 'sin' ? '√(a²-x²)' : 'a', (x0 + x1)/2, y0 + 25);

                // Opposite (vertical)
                ctx.save();
                ctx.translate(x1 + 25, (y1 + y2)/2);
                ctx.fillText(type === 'sec' ? '√(x²-a²)' : 'x', 0, 0);
                ctx.restore();

                // Hypotenuse
                const hx = (x0 + x2)/2 - 30;
                const hy = (y0 + y2)/2;
                ctx.fillText(type === 'tan' ? '√(a²+x²)' : (type === 'sec' ? 'x' : 'a'), hx, hy);

                // Info
                infoBox.innerHTML = `
                    <div class="info-row"><span class="info-label">${label1}</span></div>
                    <div class="info-row"><span class="info-label">${label2}</span></div>
                    <div class="info-row"><span class="info-label">${label3}</span></div>
                `;
            }

            typeSelect.addEventListener('change', draw);
            thetaSlider.addEventListener('input', draw);
            draw();
        }

        // ===== KINETICS VISUALIZATION =====
        function initKineticsViz() {
            const canvas = document.getElementById('kineticsCanvas');
            const ctx = canvas.getContext('2d');
            const kSlider = document.getElementById('kSlider');
            const a0Slider = document.getElementById('a0Slider');

            function draw() {
                const k = parseFloat(kSlider.value);
                const A0 = parseFloat(a0Slider.value);
                document.getElementById('kValue').textContent = k.toFixed(2);
                document.getElementById('a0Value').textContent = A0.toFixed(1);

                const tHalf = 1 / (k * A0);
                document.getElementById('halfLifeValue').textContent = `t₁/₂ = ${tHalf.toFixed(1)} s`;

                const width = canvas.width;
                const height = canvas.height;
                const padding = 50;

                ctx.clearRect(0, 0, width, height);

                // Second order: [A] = A0 / (1 + k*A0*t)
                const A = t => A0 / (1 + k * A0 * t);
                // First order comparison
                const A1st = t => A0 * Math.exp(-k * t);

                const tMax = Math.min(200, 5 * tHalf);
                const xScale = (width - 2*padding) / tMax;
                const yScale = (height - 2*padding) / (A0 * 1.2);

                const toCanvasX = t => padding + t * xScale;
                const toCanvasY = a => height - padding - a * yScale;

                // Axes
                ctx.strokeStyle = '#6b6b6b';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(padding, height - padding);
                ctx.lineTo(width - padding, height - padding);
                ctx.moveTo(padding, height - padding);
                ctx.lineTo(padding, padding);
                ctx.stroke();

                // Second order curve
                ctx.strokeStyle = '#4a9eff';
                ctx.lineWidth = 3;
                ctx.beginPath();
                for (let t = 0; t <= tMax; t += tMax/200) {
                    const y = A(t);
                    if (t === 0) ctx.moveTo(toCanvasX(t), toCanvasY(y));
                    else ctx.lineTo(toCanvasX(t), toCanvasY(y));
                }
                ctx.stroke();

                // First order comparison
                ctx.strokeStyle = '#ef4444';
                ctx.lineWidth = 2;
                ctx.setLineDash([5, 5]);
                ctx.beginPath();
                for (let t = 0; t <= tMax; t += tMax/200) {
                    const y = A1st(t);
                    if (t === 0) ctx.moveTo(toCanvasX(t), toCanvasY(y));
                    else ctx.lineTo(toCanvasX(t), toCanvasY(y));
                }
                ctx.stroke();
                ctx.setLineDash([]);

                // Half-life marker
                if (tHalf < tMax) {
                    ctx.fillStyle = '#10b981';
                    ctx.beginPath();
                    ctx.arc(toCanvasX(tHalf), toCanvasY(A0/2), 8, 0, 2*Math.PI);
                    ctx.fill();

                    ctx.strokeStyle = '#10b981';
                    ctx.lineWidth = 1;
                    ctx.setLineDash([3, 3]);
                    ctx.beginPath();
                    ctx.moveTo(toCanvasX(tHalf), toCanvasY(0));
                    ctx.lineTo(toCanvasX(tHalf), toCanvasY(A0/2));
                    ctx.moveTo(toCanvasX(0), toCanvasY(A0/2));
                    ctx.lineTo(toCanvasX(tHalf), toCanvasY(A0/2));
                    ctx.stroke();
                    ctx.setLineDash([]);
                }

                // Labels
                ctx.fillStyle = '#e8e6e3';
                ctx.font = '14px Inter';
                ctx.textAlign = 'center';
                ctx.fillText('Time (s)', width/2, height - 10);

                ctx.save();
                ctx.translate(15, height/2);
                ctx.rotate(-Math.PI/2);
                ctx.fillText('[A] (M)', 0, 0);
                ctx.restore();

                ctx.fillStyle = '#4a9eff';
                ctx.textAlign = 'left';
                ctx.fillText('Second order', width - padding - 100, padding + 20);
                ctx.fillStyle = '#ef4444';
                ctx.fillText('First order', width - padding - 100, padding + 40);
            }

            kSlider.addEventListener('input', draw);
            a0Slider.addEventListener('input', draw);
            draw();
        }

        // ===== GAUSSIAN VISUALIZATION =====
        function initGaussViz() {
            const canvas = document.getElementById('gaussCanvas');
            const ctx = canvas.getContext('2d');
            const alphaSlider = document.getElementById('alphaSlider');

            function draw() {
                const alpha = parseFloat(alphaSlider.value);
                document.getElementById('alphaValue').textContent = alpha.toFixed(1);

                const integral = Math.sqrt(Math.PI) / (4 * Math.pow(alpha, 1.5));
                document.getElementById('gaussResult').textContent =
                    `√π/(4α^(3/2)) = ${integral.toFixed(4)}`;

                const width = canvas.width;
                const height = canvas.height;
                const padding = 50;

                ctx.clearRect(0, 0, width, height);

                const f = x => x * x * Math.exp(-alpha * x * x);

                const xMax = 3;
                const xScale = (width - 2*padding) / xMax;

                // Find y max
                let yMax = 0;
                for (let x = 0; x <= xMax; x += 0.1) {
                    yMax = Math.max(yMax, f(x));
                }
                yMax *= 1.2;
                const yScale = (height - 2*padding) / yMax;

                const toCanvasX = x => padding + x * xScale;
                const toCanvasY = y => height - padding - y * yScale;

                // Shaded area
                ctx.fillStyle = 'rgba(168, 85, 247, 0.3)';
                ctx.beginPath();
                ctx.moveTo(toCanvasX(0), toCanvasY(0));
                for (let x = 0; x <= xMax; x += 0.02) {
                    ctx.lineTo(toCanvasX(x), toCanvasY(f(x)));
                }
                ctx.lineTo(toCanvasX(xMax), toCanvasY(0));
                ctx.closePath();
                ctx.fill();

                // Curve
                ctx.strokeStyle = '#a855f7';
                ctx.lineWidth = 3;
                ctx.beginPath();
                for (let x = 0; x <= xMax; x += 0.02) {
                    if (x === 0) ctx.moveTo(toCanvasX(x), toCanvasY(f(x)));
                    else ctx.lineTo(toCanvasX(x), toCanvasY(f(x)));
                }
                ctx.stroke();

                // Axes
                ctx.strokeStyle = '#6b6b6b';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(padding, height - padding);
                ctx.lineTo(width - padding, height - padding);
                ctx.moveTo(padding, height - padding);
                ctx.lineTo(padding, padding);
                ctx.stroke();

                // Labels
                ctx.fillStyle = '#e8e6e3';
                ctx.font = '14px Inter';
                ctx.textAlign = 'center';
                ctx.fillText('x', width - padding + 20, height - padding);
                ctx.fillText('0', toCanvasX(0), height - padding + 20);

                ctx.fillStyle = '#a855f7';
                ctx.font = '16px Inter';
                ctx.fillText(`x² e^(-${alpha}x²)`, width/2, padding + 20);
            }

            alphaSlider.addEventListener('input', draw);
            draw();
        }
    </script>
</body>
</html>
